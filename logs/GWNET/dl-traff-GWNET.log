data.shape (34272, 207)
pred_METR-LA_GraphWaveNet_2302201036 training started Mon Feb 20 10:36:41 2023
TRAIN XS.shape YS,shape (27394, 1, 207, 12) (27394, 12, 207, 1)
Model Training Started ... Mon Feb 20 10:36:42 2023
TIMESTEP_IN, TIMESTEP_OUT 12 12
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─Conv2d: 1-1                            [-1, 32, 207, 13]         64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-1                       [-1, 32, 207, 12]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-2                       [-1, 32, 207, 12]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-3                       [-1, 256, 207, 12]        8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-4                          [-1, 32, 207, 12]         --
|    |    └─nconv: 3-1                   [-1, 32, 207, 12]         --
|    |    └─nconv: 3-2                   [-1, 32, 207, 12]         --
|    |    └─nconv: 3-3                   [-1, 32, 207, 12]         --
|    |    └─nconv: 3-4                   [-1, 32, 207, 12]         --
|    |    └─nconv: 3-5                   [-1, 32, 207, 12]         --
|    |    └─nconv: 3-6                   [-1, 32, 207, 12]         --
|    |    └─linear: 3-7                  [-1, 32, 207, 12]         7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-5                  [-1, 32, 207, 12]         64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-6                       [-1, 32, 207, 10]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-7                       [-1, 32, 207, 10]         2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-8                       [-1, 256, 207, 10]        8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-9                          [-1, 32, 207, 10]         --
|    |    └─nconv: 3-8                   [-1, 32, 207, 10]         --
|    |    └─nconv: 3-9                   [-1, 32, 207, 10]         --
|    |    └─nconv: 3-10                  [-1, 32, 207, 10]         --
|    |    └─nconv: 3-11                  [-1, 32, 207, 10]         --
|    |    └─nconv: 3-12                  [-1, 32, 207, 10]         --
|    |    └─nconv: 3-13                  [-1, 32, 207, 10]         --
|    |    └─linear: 3-14                 [-1, 32, 207, 10]         7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-10                 [-1, 32, 207, 10]         64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-11                      [-1, 32, 207, 9]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-12                      [-1, 32, 207, 9]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-13                      [-1, 256, 207, 9]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-14                         [-1, 32, 207, 9]          --
|    |    └─nconv: 3-15                  [-1, 32, 207, 9]          --
|    |    └─nconv: 3-16                  [-1, 32, 207, 9]          --
|    |    └─nconv: 3-17                  [-1, 32, 207, 9]          --
|    |    └─nconv: 3-18                  [-1, 32, 207, 9]          --
|    |    └─nconv: 3-19                  [-1, 32, 207, 9]          --
|    |    └─nconv: 3-20                  [-1, 32, 207, 9]          --
|    |    └─linear: 3-21                 [-1, 32, 207, 9]          7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-15                 [-1, 32, 207, 9]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-16                      [-1, 32, 207, 7]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-17                      [-1, 32, 207, 7]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-18                      [-1, 256, 207, 7]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-19                         [-1, 32, 207, 7]          --
|    |    └─nconv: 3-22                  [-1, 32, 207, 7]          --
|    |    └─nconv: 3-23                  [-1, 32, 207, 7]          --
|    |    └─nconv: 3-24                  [-1, 32, 207, 7]          --
|    |    └─nconv: 3-25                  [-1, 32, 207, 7]          --
|    |    └─nconv: 3-26                  [-1, 32, 207, 7]          --
|    |    └─nconv: 3-27                  [-1, 32, 207, 7]          --
|    |    └─linear: 3-28                 [-1, 32, 207, 7]          7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-20                 [-1, 32, 207, 7]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-21                      [-1, 32, 207, 6]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-22                      [-1, 32, 207, 6]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-23                      [-1, 256, 207, 6]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-24                         [-1, 32, 207, 6]          --
|    |    └─nconv: 3-29                  [-1, 32, 207, 6]          --
|    |    └─nconv: 3-30                  [-1, 32, 207, 6]          --
|    |    └─nconv: 3-31                  [-1, 32, 207, 6]          --
|    |    └─nconv: 3-32                  [-1, 32, 207, 6]          --
|    |    └─nconv: 3-33                  [-1, 32, 207, 6]          --
|    |    └─nconv: 3-34                  [-1, 32, 207, 6]          --
|    |    └─linear: 3-35                 [-1, 32, 207, 6]          7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-25                 [-1, 32, 207, 6]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-26                      [-1, 32, 207, 4]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-27                      [-1, 32, 207, 4]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-28                      [-1, 256, 207, 4]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-29                         [-1, 32, 207, 4]          --
|    |    └─nconv: 3-36                  [-1, 32, 207, 4]          --
|    |    └─nconv: 3-37                  [-1, 32, 207, 4]          --
|    |    └─nconv: 3-38                  [-1, 32, 207, 4]          --
|    |    └─nconv: 3-39                  [-1, 32, 207, 4]          --
|    |    └─nconv: 3-40                  [-1, 32, 207, 4]          --
|    |    └─nconv: 3-41                  [-1, 32, 207, 4]          --
|    |    └─linear: 3-42                 [-1, 32, 207, 4]          7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-30                 [-1, 32, 207, 4]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-31                      [-1, 32, 207, 3]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-32                      [-1, 32, 207, 3]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-33                      [-1, 256, 207, 3]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-34                         [-1, 32, 207, 3]          --
|    |    └─nconv: 3-43                  [-1, 32, 207, 3]          --
|    |    └─nconv: 3-44                  [-1, 32, 207, 3]          --
|    |    └─nconv: 3-45                  [-1, 32, 207, 3]          --
|    |    └─nconv: 3-46                  [-1, 32, 207, 3]          --
|    |    └─nconv: 3-47                  [-1, 32, 207, 3]          --
|    |    └─nconv: 3-48                  [-1, 32, 207, 3]          --
|    |    └─linear: 3-49                 [-1, 32, 207, 3]          7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-35                 [-1, 32, 207, 3]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-36                      [-1, 32, 207, 1]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-37                      [-1, 32, 207, 1]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-38                      [-1, 256, 207, 1]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-39                         [-1, 32, 207, 1]          --
|    |    └─nconv: 3-50                  [-1, 32, 207, 1]          --
|    |    └─nconv: 3-51                  [-1, 32, 207, 1]          --
|    |    └─nconv: 3-52                  [-1, 32, 207, 1]          --
|    |    └─nconv: 3-53                  [-1, 32, 207, 1]          --
|    |    └─nconv: 3-54                  [-1, 32, 207, 1]          --
|    |    └─nconv: 3-55                  [-1, 32, 207, 1]          --
|    |    └─linear: 3-56                 [-1, 32, 207, 1]          7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-40                 [-1, 32, 207, 1]          64
├─Conv2d: 1-2                            [-1, 512, 207, 1]         131,584
├─Conv2d: 1-3                            [-1, 12, 207, 1]          6,156
==========================================================================================
Total params: 296,780
Trainable params: 296,780
Non-trainable params: 0
Total mult-adds (M): 238.03
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 33.02
Params size (MB): 1.13
Estimated Total Size (MB): 34.16
==========================================================================================
XS_torch.shape:   torch.Size([27394, 1, 207, 12])
YS_torch.shape:   torch.Size([27394, 12, 207, 1])
LOSS is : MAE
epoch 0 time used: 38  seconds  train loss: 0.2606378188655554 validation loss: 0.25087351695029403
epoch 1 time used: 38  seconds  train loss: 0.23396395056267308 validation loss: 0.23576331362237024
epoch 2 time used: 39  seconds  train loss: 0.22834910011280563 validation loss: 0.2332953775277103
epoch 3 time used: 39  seconds  train loss: 0.22431382707354075 validation loss: 0.22615503774072132
epoch 4 time used: 39  seconds  train loss: 0.22105862516324676 validation loss: 0.2354830317079586
epoch 5 time used: 39  seconds  train loss: 0.21804313954980648 validation loss: 0.2216373434205995
epoch 6 time used: 39  seconds  train loss: 0.2149623528323706 validation loss: 0.22104850936110002
epoch 7 time used: 39  seconds  train loss: 0.21273930161672905 validation loss: 0.22031696771618223
epoch 8 time used: 39  seconds  train loss: 0.21092108353823852 validation loss: 0.2187855520735692
epoch 9 time used: 39  seconds  train loss: 0.20863781280986876 validation loss: 0.21863025547814194
epoch 10 time used: 39  seconds  train loss: 0.20687323615450431 validation loss: 0.22162393218409407
epoch 11 time used: 39  seconds  train loss: 0.2059807441626648 validation loss: 0.2136972630633055
epoch 12 time used: 39  seconds  train loss: 0.20523673351988525 validation loss: 0.2160221860878659
epoch 13 time used: 39  seconds  train loss: 0.20413672997711388 validation loss: 0.21129407383229612
epoch 14 time used: 39  seconds  train loss: 0.20301902622532808 validation loss: 0.21973350012824483
epoch 15 time used: 40  seconds  train loss: 0.20270397454019015 validation loss: 0.21146515130996704
epoch 16 time used: 40  seconds  train loss: 0.20096827752201551 validation loss: 0.2113725387527995
epoch 17 time used: 40  seconds  train loss: 0.20111176128993022 validation loss: 0.21241850392226755
epoch 18 time used: 39  seconds  train loss: 0.20041525182887526 validation loss: 0.21435288363999694
epoch 19 time used: 39  seconds  train loss: 0.19947282525695725 validation loss: 0.21236504036144618
epoch 20 time used: 39  seconds  train loss: 0.19852377550464392 validation loss: 0.2145139785578651
epoch 21 time used: 39  seconds  train loss: 0.19776077146220603 validation loss: 0.21172920819181595
epoch 22 time used: 39  seconds  train loss: 0.19720430007339085 validation loss: 0.2139582819007609
Early stopping at epoch: 23
YS.shape, YS_pred.shape, (27394, 12, 207, 1) (27394, 12, 207, 1)
YS.shape, YS_pred.shape, (27394, 12, 207) (27394, 12, 207)
****************************************
GraphWaveNet, train, Torch MSE, 1.9321150895e-01, 0.1932115089
GraphWaveNet, train, MSE, RMSE, MAE, MAPE, 60.4529162776, 7.7751473476, 3.2853326620, 8.3059183183
Model Training Ended ... Mon Feb 20 10:53:23 2023
pred_METR-LA_GraphWaveNet_2302201036 testing started Mon Feb 20 10:53:23 2023
TEST XS.shape, YS.shape (6844, 1, 207, 12) (6844, 12, 207, 1)
Model Testing Started ... Mon Feb 20 10:53:23 2023
TIMESTEP_IN, TIMESTEP_OUT 12 12
YS.shape, YS_pred.shape, (6844, 12, 207, 1) (6844, 12, 207, 1)
YS.shape, YS_pred.shape, (6844, 12, 207) (6844, 12, 207)
****************************************
GraphWaveNet, test, Torch MSE, 2.3801235754e-01, 0.2380123575
all pred steps, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 87.7803115804, 9.3691147704, 3.9240304949, 9.6099728037
1 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 30.1743555841, 5.4931189305, 2.5345917961, 5.8068675316
2 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 42.9495655585, 6.5535918059, 2.9320559335, 6.8890356206
3 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 54.8216656420, 7.4041654251, 3.2413698906, 7.7496182369
4 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 67.3535343784, 8.2069199081, 3.5350550491, 8.5187415802
5 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 78.5461889810, 8.8626287850, 3.7613049525, 9.1669130601
6 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 88.7392885673, 9.4201533197, 3.9624027444, 9.7352583844
7 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 97.1501745505, 9.8564788109, 4.1543958497, 10.2548538287
8 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 104.8649662167, 10.2403596722, 4.3103216268, 10.7034865909
9 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 111.4068501519, 10.5549443462, 4.4599945823, 11.0977304519
10 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 118.8608526093, 10.9023324389, 4.5916386838, 11.4442051884
11 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 125.9764448100, 11.2239228797, 4.7385799821, 11.7993956799
12 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 132.5261863564, 11.5120018397, 4.8667941748, 12.1539479198
