PEMSBAY
Trainset:	x-(36465, 12, 325, 3)	y-(36465, 12, 325, 1)
Valset:  	x-(5209, 12, 325, 3)  	y-(5209, 12, 325, 1)
Testset:	x-(10419, 12, 325, 3)	y-(10419, 12, 325, 1)

--------- STID ---------
{
    "num_nodes": 325,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.002,
    "weight_decay": 0.0001,
    "milestones": [
        1,
        50,
        80
    ],
    "lr_decay_rate": 0.5,
    "batch_size": 32,
    "max_epochs": 200,
    "early_stop": 30,
    "use_cl": false,
    "model_args": {
        "num_nodes": 325,
        "input_len": 12,
        "output_len": 12,
        "input_dim": 3,
        "embed_dim": 32,
        "node_dim": 32,
        "temp_dim_tid": 32,
        "temp_dim_diw": 32,
        "time_of_day_size": 288,
        "day_of_week_size": 7,
        "if_node": true,
        "if_time_in_day": true,
        "if_day_in_week": true,
        "num_layer": 3
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
STID                                     --                        --
├─Conv2d: 1-1                            [32, 32, 325, 1]          1,184
├─Sequential: 1-2                        [32, 128, 325, 1]         --
│    └─MultiLayerPerceptron: 2-1         [32, 128, 325, 1]         --
│    │    └─Conv2d: 3-1                  [32, 128, 325, 1]         16,512
│    │    └─ReLU: 3-2                    [32, 128, 325, 1]         --
│    │    └─Dropout: 3-3                 [32, 128, 325, 1]         --
│    │    └─Conv2d: 3-4                  [32, 128, 325, 1]         16,512
│    └─MultiLayerPerceptron: 2-2         [32, 128, 325, 1]         --
│    │    └─Conv2d: 3-5                  [32, 128, 325, 1]         16,512
│    │    └─ReLU: 3-6                    [32, 128, 325, 1]         --
│    │    └─Dropout: 3-7                 [32, 128, 325, 1]         --
│    │    └─Conv2d: 3-8                  [32, 128, 325, 1]         16,512
│    └─MultiLayerPerceptron: 2-3         [32, 128, 325, 1]         --
│    │    └─Conv2d: 3-9                  [32, 128, 325, 1]         16,512
│    │    └─ReLU: 3-10                   [32, 128, 325, 1]         --
│    │    └─Dropout: 3-11                [32, 128, 325, 1]         --
│    │    └─Conv2d: 3-12                 [32, 128, 325, 1]         16,512
├─Conv2d: 1-3                            [32, 12, 325, 1]          1,548
==========================================================================================
Total params: 101,804
Trainable params: 101,804
Non-trainable params: 0
Total mult-adds (G): 1.06
==========================================================================================
Input size (MB): 1.50
Forward/backward pass size (MB): 67.56
Params size (MB): 0.41
Estimated Total Size (MB): 69.46
==========================================================================================

Loss: MaskedMAELoss

2023-04-10 18:45:50.414085 Epoch 1  	Train Loss = 1.88663 Val Loss = 1.82941
2023-04-10 18:46:11.878175 Epoch 2  	Train Loss = 1.64604 Val Loss = 1.76569
2023-04-10 18:46:32.656837 Epoch 3  	Train Loss = 1.61183 Val Loss = 1.69933
2023-04-10 18:46:53.253409 Epoch 4  	Train Loss = 1.59292 Val Loss = 1.69617
2023-04-10 18:47:13.997699 Epoch 5  	Train Loss = 1.57885 Val Loss = 1.70830
2023-04-10 18:47:34.843062 Epoch 6  	Train Loss = 1.56798 Val Loss = 1.67202
2023-04-10 18:47:55.101490 Epoch 7  	Train Loss = 1.56291 Val Loss = 1.66648
2023-04-10 18:48:15.901405 Epoch 8  	Train Loss = 1.55486 Val Loss = 1.67550
2023-04-10 18:48:37.046046 Epoch 9  	Train Loss = 1.54990 Val Loss = 1.66135
2023-04-10 18:48:58.013791 Epoch 10  	Train Loss = 1.54516 Val Loss = 1.66577
2023-04-10 18:49:18.840647 Epoch 11  	Train Loss = 1.54192 Val Loss = 1.65173
2023-04-10 18:49:39.470517 Epoch 12  	Train Loss = 1.53994 Val Loss = 1.63495
2023-04-10 18:50:00.341152 Epoch 13  	Train Loss = 1.53640 Val Loss = 1.64402
2023-04-10 18:50:21.054847 Epoch 14  	Train Loss = 1.53573 Val Loss = 1.63376
2023-04-10 18:50:41.955122 Epoch 15  	Train Loss = 1.53250 Val Loss = 1.62391
2023-04-10 18:51:03.255797 Epoch 16  	Train Loss = 1.53117 Val Loss = 1.64307
2023-04-10 18:51:23.240447 Epoch 17  	Train Loss = 1.52877 Val Loss = 1.65279
2023-04-10 18:51:44.137199 Epoch 18  	Train Loss = 1.52793 Val Loss = 1.66284
2023-04-10 18:52:03.930206 Epoch 19  	Train Loss = 1.52673 Val Loss = 1.62207
2023-04-10 18:52:25.002485 Epoch 20  	Train Loss = 1.52520 Val Loss = 1.62292
2023-04-10 18:52:46.117660 Epoch 21  	Train Loss = 1.52488 Val Loss = 1.61870
2023-04-10 18:53:07.173011 Epoch 22  	Train Loss = 1.52363 Val Loss = 1.63822
2023-04-10 18:53:28.051065 Epoch 23  	Train Loss = 1.52190 Val Loss = 1.63013
2023-04-10 18:53:47.798872 Epoch 24  	Train Loss = 1.52105 Val Loss = 1.63065
2023-04-10 18:54:08.527033 Epoch 25  	Train Loss = 1.52142 Val Loss = 1.62816
2023-04-10 18:54:29.554061 Epoch 26  	Train Loss = 1.51927 Val Loss = 1.62699
2023-04-10 18:54:50.599671 Epoch 27  	Train Loss = 1.51828 Val Loss = 1.61918
2023-04-10 18:55:11.577539 Epoch 28  	Train Loss = 1.51788 Val Loss = 1.64796
2023-04-10 18:55:31.962909 Epoch 29  	Train Loss = 1.51721 Val Loss = 1.62356
2023-04-10 18:55:52.752974 Epoch 30  	Train Loss = 1.51712 Val Loss = 1.61572
2023-04-10 18:56:13.598978 Epoch 31  	Train Loss = 1.51537 Val Loss = 1.62907
2023-04-10 18:56:34.364922 Epoch 32  	Train Loss = 1.51413 Val Loss = 1.62556
2023-04-10 18:56:55.511978 Epoch 33  	Train Loss = 1.51461 Val Loss = 1.63127
2023-04-10 18:57:16.825213 Epoch 34  	Train Loss = 1.51469 Val Loss = 1.61001
2023-04-10 18:57:37.856882 Epoch 35  	Train Loss = 1.51325 Val Loss = 1.65592
2023-04-10 18:57:59.249377 Epoch 36  	Train Loss = 1.51209 Val Loss = 1.62645
2023-04-10 18:58:20.565256 Epoch 37  	Train Loss = 1.51267 Val Loss = 1.62278
2023-04-10 18:58:41.460046 Epoch 38  	Train Loss = 1.51244 Val Loss = 1.60644
2023-04-10 18:59:03.119986 Epoch 39  	Train Loss = 1.51186 Val Loss = 1.61771
2023-04-10 18:59:24.092811 Epoch 40  	Train Loss = 1.51072 Val Loss = 1.63301
2023-04-10 18:59:45.263975 Epoch 41  	Train Loss = 1.51097 Val Loss = 1.61915
2023-04-10 19:00:05.888438 Epoch 42  	Train Loss = 1.51139 Val Loss = 1.60931
2023-04-10 19:00:27.163294 Epoch 43  	Train Loss = 1.51032 Val Loss = 1.61489
2023-04-10 19:00:48.428666 Epoch 44  	Train Loss = 1.50903 Val Loss = 1.62735
2023-04-10 19:01:09.688324 Epoch 45  	Train Loss = 1.50872 Val Loss = 1.60916
2023-04-10 19:01:30.860757 Epoch 46  	Train Loss = 1.50904 Val Loss = 1.62233
2023-04-10 19:01:52.046246 Epoch 47  	Train Loss = 1.50773 Val Loss = 1.62055
2023-04-10 19:02:13.236133 Epoch 48  	Train Loss = 1.50917 Val Loss = 1.62104
2023-04-10 19:02:33.933045 Epoch 49  	Train Loss = 1.50797 Val Loss = 1.60595
2023-04-10 19:02:55.028724 Epoch 50  	Train Loss = 1.50851 Val Loss = 1.61870
2023-04-10 19:03:15.660562 Epoch 51  	Train Loss = 1.49167 Val Loss = 1.59977
2023-04-10 19:03:36.798260 Epoch 52  	Train Loss = 1.49015 Val Loss = 1.61630
2023-04-10 19:03:57.832812 Epoch 53  	Train Loss = 1.49028 Val Loss = 1.61004
2023-04-10 19:04:18.722259 Epoch 54  	Train Loss = 1.48934 Val Loss = 1.60910
2023-04-10 19:04:39.879888 Epoch 55  	Train Loss = 1.48939 Val Loss = 1.59767
2023-04-10 19:05:01.080839 Epoch 56  	Train Loss = 1.48940 Val Loss = 1.59757
2023-04-10 19:05:21.979473 Epoch 57  	Train Loss = 1.48883 Val Loss = 1.60234
2023-04-10 19:05:42.883183 Epoch 58  	Train Loss = 1.48892 Val Loss = 1.59723
2023-04-10 19:06:03.588033 Epoch 59  	Train Loss = 1.48850 Val Loss = 1.61967
2023-04-10 19:06:25.010954 Epoch 60  	Train Loss = 1.48863 Val Loss = 1.59473
2023-04-10 19:06:46.290732 Epoch 61  	Train Loss = 1.48825 Val Loss = 1.59793
2023-04-10 19:07:07.393365 Epoch 62  	Train Loss = 1.48823 Val Loss = 1.60293
2023-04-10 19:07:28.890712 Epoch 63  	Train Loss = 1.48781 Val Loss = 1.59246
2023-04-10 19:07:47.008381 Epoch 64  	Train Loss = 1.48788 Val Loss = 1.60163
2023-04-10 19:08:04.638599 Epoch 65  	Train Loss = 1.48739 Val Loss = 1.59553
2023-04-10 19:08:22.713627 Epoch 66  	Train Loss = 1.48730 Val Loss = 1.59882
2023-04-10 19:08:40.599279 Epoch 67  	Train Loss = 1.48841 Val Loss = 1.60116
2023-04-10 19:08:58.559573 Epoch 68  	Train Loss = 1.48819 Val Loss = 1.60130
2023-04-10 19:09:16.572257 Epoch 69  	Train Loss = 1.48698 Val Loss = 1.61585
2023-04-10 19:09:34.608335 Epoch 70  	Train Loss = 1.48779 Val Loss = 1.59694
2023-04-10 19:09:52.163646 Epoch 71  	Train Loss = 1.48711 Val Loss = 1.62195
2023-04-10 19:10:10.308808 Epoch 72  	Train Loss = 1.48730 Val Loss = 1.62461
2023-04-10 19:10:28.366967 Epoch 73  	Train Loss = 1.48707 Val Loss = 1.60118
2023-04-10 19:10:46.516531 Epoch 74  	Train Loss = 1.48684 Val Loss = 1.60235
2023-04-10 19:11:04.651131 Epoch 75  	Train Loss = 1.48702 Val Loss = 1.60923
2023-04-10 19:11:22.829115 Epoch 76  	Train Loss = 1.48715 Val Loss = 1.59852
2023-04-10 19:11:40.915822 Epoch 77  	Train Loss = 1.48660 Val Loss = 1.59877
2023-04-10 19:11:58.845328 Epoch 78  	Train Loss = 1.48636 Val Loss = 1.59721
2023-04-10 19:12:16.919496 Epoch 79  	Train Loss = 1.48632 Val Loss = 1.60091
2023-04-10 19:12:35.152866 Epoch 80  	Train Loss = 1.48613 Val Loss = 1.60972
2023-04-10 19:12:53.162717 Epoch 81  	Train Loss = 1.47673 Val Loss = 1.58905
2023-04-10 19:13:10.979572 Epoch 82  	Train Loss = 1.47579 Val Loss = 1.58995
2023-04-10 19:13:28.672901 Epoch 83  	Train Loss = 1.47576 Val Loss = 1.59471
2023-04-10 19:13:46.870912 Epoch 84  	Train Loss = 1.47532 Val Loss = 1.58830
2023-04-10 19:14:04.800314 Epoch 85  	Train Loss = 1.47491 Val Loss = 1.59118
2023-04-10 19:14:22.665387 Epoch 86  	Train Loss = 1.47511 Val Loss = 1.59023
2023-04-10 19:14:40.730084 Epoch 87  	Train Loss = 1.47541 Val Loss = 1.58919
2023-04-10 19:14:58.688863 Epoch 88  	Train Loss = 1.47516 Val Loss = 1.58597
2023-04-10 19:15:16.775160 Epoch 89  	Train Loss = 1.47457 Val Loss = 1.59726
2023-04-10 19:15:34.736280 Epoch 90  	Train Loss = 1.47472 Val Loss = 1.59219
2023-04-10 19:15:53.741022 Epoch 91  	Train Loss = 1.47480 Val Loss = 1.59430
2023-04-10 19:16:11.602191 Epoch 92  	Train Loss = 1.47462 Val Loss = 1.59526
2023-04-10 19:16:29.655333 Epoch 93  	Train Loss = 1.47460 Val Loss = 1.59164
2023-04-10 19:16:47.744796 Epoch 94  	Train Loss = 1.47455 Val Loss = 1.60190
2023-04-10 19:17:05.890550 Epoch 95  	Train Loss = 1.47401 Val Loss = 1.58703
2023-04-10 19:17:23.759644 Epoch 96  	Train Loss = 1.47391 Val Loss = 1.58696
2023-04-10 19:17:41.548951 Epoch 97  	Train Loss = 1.47452 Val Loss = 1.59371
2023-04-10 19:17:59.406889 Epoch 98  	Train Loss = 1.47407 Val Loss = 1.58770
2023-04-10 19:18:17.366994 Epoch 99  	Train Loss = 1.47412 Val Loss = 1.58574
2023-04-10 19:18:35.523509 Epoch 100  	Train Loss = 1.47400 Val Loss = 1.59435
2023-04-10 19:18:53.520353 Epoch 101  	Train Loss = 1.47412 Val Loss = 1.59641
2023-04-10 19:19:11.485219 Epoch 102  	Train Loss = 1.47377 Val Loss = 1.59102
2023-04-10 19:19:29.706209 Epoch 103  	Train Loss = 1.47431 Val Loss = 1.58609
2023-04-10 19:19:47.643204 Epoch 104  	Train Loss = 1.47383 Val Loss = 1.58878
2023-04-10 19:20:05.348468 Epoch 105  	Train Loss = 1.47385 Val Loss = 1.59438
2023-04-10 19:20:23.248313 Epoch 106  	Train Loss = 1.47400 Val Loss = 1.59407
2023-04-10 19:20:41.243624 Epoch 107  	Train Loss = 1.47353 Val Loss = 1.58479
2023-04-10 19:20:59.212918 Epoch 108  	Train Loss = 1.47409 Val Loss = 1.59292
2023-04-10 19:21:17.133413 Epoch 109  	Train Loss = 1.47371 Val Loss = 1.57777
2023-04-10 19:21:35.330239 Epoch 110  	Train Loss = 1.47346 Val Loss = 1.60142
2023-04-10 19:21:53.751390 Epoch 111  	Train Loss = 1.47352 Val Loss = 1.58716
2023-04-10 19:22:12.207378 Epoch 112  	Train Loss = 1.47342 Val Loss = 1.58925
2023-04-10 19:22:30.244059 Epoch 113  	Train Loss = 1.47321 Val Loss = 1.59269
2023-04-10 19:22:48.393416 Epoch 114  	Train Loss = 1.47312 Val Loss = 1.58883
2023-04-10 19:23:06.623574 Epoch 115  	Train Loss = 1.47330 Val Loss = 1.58398
2023-04-10 19:23:24.719058 Epoch 116  	Train Loss = 1.47308 Val Loss = 1.59645
2023-04-10 19:23:42.934793 Epoch 117  	Train Loss = 1.47339 Val Loss = 1.59257
2023-04-10 19:24:02.072885 Epoch 118  	Train Loss = 1.47339 Val Loss = 1.60100
2023-04-10 19:24:20.462882 Epoch 119  	Train Loss = 1.47329 Val Loss = 1.58863
2023-04-10 19:24:38.506040 Epoch 120  	Train Loss = 1.47308 Val Loss = 1.59501
2023-04-10 19:24:56.763149 Epoch 121  	Train Loss = 1.47319 Val Loss = 1.58954
2023-04-10 19:25:14.981125 Epoch 122  	Train Loss = 1.47269 Val Loss = 1.58896
2023-04-10 19:25:33.008368 Epoch 123  	Train Loss = 1.47268 Val Loss = 1.58952
2023-04-10 19:25:50.811106 Epoch 124  	Train Loss = 1.47308 Val Loss = 1.59758
2023-04-10 19:26:08.746259 Epoch 125  	Train Loss = 1.47278 Val Loss = 1.58558
2023-04-10 19:26:26.856289 Epoch 126  	Train Loss = 1.47300 Val Loss = 1.58902
2023-04-10 19:26:44.842258 Epoch 127  	Train Loss = 1.47297 Val Loss = 1.58367
2023-04-10 19:27:02.858718 Epoch 128  	Train Loss = 1.47281 Val Loss = 1.59052
2023-04-10 19:27:21.033749 Epoch 129  	Train Loss = 1.47305 Val Loss = 1.58220
2023-04-10 19:27:39.057250 Epoch 130  	Train Loss = 1.47271 Val Loss = 1.58846
2023-04-10 19:27:57.152288 Epoch 131  	Train Loss = 1.47248 Val Loss = 1.58427
2023-04-10 19:28:15.936187 Epoch 132  	Train Loss = 1.47263 Val Loss = 1.59349
2023-04-10 19:28:33.942745 Epoch 133  	Train Loss = 1.47253 Val Loss = 1.59623
2023-04-10 19:28:52.098204 Epoch 134  	Train Loss = 1.47257 Val Loss = 1.58477
2023-04-10 19:29:10.315896 Epoch 135  	Train Loss = 1.47268 Val Loss = 1.59058
2023-04-10 19:29:28.304961 Epoch 136  	Train Loss = 1.47274 Val Loss = 1.58647
2023-04-10 19:29:46.281568 Epoch 137  	Train Loss = 1.47196 Val Loss = 1.60500
2023-04-10 19:30:04.402103 Epoch 138  	Train Loss = 1.47295 Val Loss = 1.58872
2023-04-10 19:30:22.864998 Epoch 139  	Train Loss = 1.47217 Val Loss = 1.58240
Early stopping at epoch: 139
Best at epoch 109:
Train Loss = 1.47371
Train RMSE = 3.25808, MAE = 1.44282, MAPE = 3.11069
Val Loss = 1.57777
Val RMSE = 3.68457, MAE = 1.58059, MAPE = 3.65491
--------- Test ---------
All Steps RMSE = 3.61479, MAE = 1.56457, MAPE = 3.55402
Step 1 RMSE = 1.56511, MAE = 0.85500, MAPE = 1.64351
Step 2 RMSE = 2.25891, MAE = 1.12807, MAPE = 2.28947
Step 3 RMSE = 2.78718, MAE = 1.31332, MAPE = 2.77919
Step 4 RMSE = 3.18707, MAE = 1.44858, MAPE = 3.16950
Step 5 RMSE = 3.48923, MAE = 1.55119, MAPE = 3.48118
Step 6 RMSE = 3.72300, MAE = 1.63257, MAPE = 3.73229
Step 7 RMSE = 3.90589, MAE = 1.69730, MAPE = 3.93424
Step 8 RMSE = 4.04890, MAE = 1.74974, MAPE = 4.09605
Step 9 RMSE = 4.16079, MAE = 1.79381, MAPE = 4.22818
Step 10 RMSE = 4.25234, MAE = 1.83213, MAPE = 4.33714
Step 11 RMSE = 4.33256, MAE = 1.86771, MAPE = 4.43209
Step 12 RMSE = 4.41260, MAE = 1.90543, MAPE = 4.52535
Inference time: 1.00 s
