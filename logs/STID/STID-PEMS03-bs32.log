PEMS03
Trainset:	x-(15711, 12, 358, 3)	y-(15711, 12, 358, 1)
Valset:  	x-(5237, 12, 358, 3)  	y-(5237, 12, 358, 1)
Testset:	x-(5237, 12, 358, 3)	y-(5237, 12, 358, 1)

--------- STID ---------
{
    "num_nodes": 358,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.002,
    "weight_decay": 0.0001,
    "milestones": [
        1,
        50,
        80
    ],
    "lr_decay_rate": 0.5,
    "batch_size": 32,
    "max_epochs": 200,
    "early_stop": 30,
    "use_cl": false,
    "model_args": {
        "num_nodes": 358,
        "input_len": 12,
        "output_len": 12,
        "input_dim": 3,
        "embed_dim": 32,
        "node_dim": 32,
        "temp_dim_tid": 32,
        "temp_dim_diw": 32,
        "time_of_day_size": 288,
        "day_of_week_size": 7,
        "if_node": true,
        "if_time_in_day": true,
        "if_day_in_week": true,
        "num_layer": 3
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
STID                                     --                        --
├─Conv2d: 1-1                            [32, 32, 358, 1]          1,184
├─Sequential: 1-2                        [32, 128, 358, 1]         --
│    └─MultiLayerPerceptron: 2-1         [32, 128, 358, 1]         --
│    │    └─Conv2d: 3-1                  [32, 128, 358, 1]         16,512
│    │    └─ReLU: 3-2                    [32, 128, 358, 1]         --
│    │    └─Dropout: 3-3                 [32, 128, 358, 1]         --
│    │    └─Conv2d: 3-4                  [32, 128, 358, 1]         16,512
│    └─MultiLayerPerceptron: 2-2         [32, 128, 358, 1]         --
│    │    └─Conv2d: 3-5                  [32, 128, 358, 1]         16,512
│    │    └─ReLU: 3-6                    [32, 128, 358, 1]         --
│    │    └─Dropout: 3-7                 [32, 128, 358, 1]         --
│    │    └─Conv2d: 3-8                  [32, 128, 358, 1]         16,512
│    └─MultiLayerPerceptron: 2-3         [32, 128, 358, 1]         --
│    │    └─Conv2d: 3-9                  [32, 128, 358, 1]         16,512
│    │    └─ReLU: 3-10                   [32, 128, 358, 1]         --
│    │    └─Dropout: 3-11                [32, 128, 358, 1]         --
│    │    └─Conv2d: 3-12                 [32, 128, 358, 1]         16,512
├─Conv2d: 1-3                            [32, 12, 358, 1]          1,548
==========================================================================================
Total params: 101,804
Trainable params: 101,804
Non-trainable params: 0
Total mult-adds (G): 1.17
==========================================================================================
Input size (MB): 1.65
Forward/backward pass size (MB): 74.42
Params size (MB): 0.41
Estimated Total Size (MB): 76.48
==========================================================================================

Loss: HuberLoss

2023-04-10 18:45:37.540918 Epoch 1  	Train Loss = 19.90178 Val Loss = 15.70822
2023-04-10 18:45:46.908871 Epoch 2  	Train Loss = 15.26725 Val Loss = 14.78802
2023-04-10 18:45:56.024857 Epoch 3  	Train Loss = 14.77218 Val Loss = 14.52877
2023-04-10 18:46:05.449360 Epoch 4  	Train Loss = 14.45071 Val Loss = 14.24548
2023-04-10 18:46:14.569749 Epoch 5  	Train Loss = 14.22238 Val Loss = 14.35222
2023-04-10 18:46:23.965301 Epoch 6  	Train Loss = 14.02824 Val Loss = 14.08904
2023-04-10 18:46:33.457779 Epoch 7  	Train Loss = 13.90031 Val Loss = 13.84452
2023-04-10 18:46:42.628740 Epoch 8  	Train Loss = 13.77724 Val Loss = 13.74831
2023-04-10 18:46:51.643392 Epoch 9  	Train Loss = 13.72339 Val Loss = 13.75727
2023-04-10 18:47:01.029443 Epoch 10  	Train Loss = 13.60849 Val Loss = 13.63382
2023-04-10 18:47:10.316485 Epoch 11  	Train Loss = 13.54133 Val Loss = 13.65363
2023-04-10 18:47:19.498524 Epoch 12  	Train Loss = 13.47102 Val Loss = 13.73245
2023-04-10 18:47:28.935734 Epoch 13  	Train Loss = 13.40965 Val Loss = 13.89378
2023-04-10 18:47:38.211943 Epoch 14  	Train Loss = 13.37745 Val Loss = 13.87069
2023-04-10 18:47:47.386003 Epoch 15  	Train Loss = 13.33444 Val Loss = 13.61725
2023-04-10 18:47:56.597265 Epoch 16  	Train Loss = 13.28749 Val Loss = 13.60627
2023-04-10 18:48:06.044433 Epoch 17  	Train Loss = 13.23377 Val Loss = 13.51726
2023-04-10 18:48:15.350866 Epoch 18  	Train Loss = 13.20610 Val Loss = 13.80091
2023-04-10 18:48:24.694655 Epoch 19  	Train Loss = 13.19071 Val Loss = 13.49759
2023-04-10 18:48:34.012767 Epoch 20  	Train Loss = 13.14580 Val Loss = 13.49663
2023-04-10 18:48:43.431987 Epoch 21  	Train Loss = 13.11898 Val Loss = 13.50816
2023-04-10 18:48:52.743005 Epoch 22  	Train Loss = 13.10384 Val Loss = 13.51940
2023-04-10 18:49:01.080523 Epoch 23  	Train Loss = 13.10658 Val Loss = 13.43030
2023-04-10 18:49:10.445853 Epoch 24  	Train Loss = 13.07653 Val Loss = 13.56359
2023-04-10 18:49:19.317670 Epoch 25  	Train Loss = 13.06608 Val Loss = 13.55869
2023-04-10 18:49:28.580655 Epoch 26  	Train Loss = 13.05600 Val Loss = 13.51629
2023-04-10 18:49:37.594232 Epoch 27  	Train Loss = 13.02043 Val Loss = 13.52150
2023-04-10 18:49:46.836997 Epoch 28  	Train Loss = 13.00563 Val Loss = 13.65884
2023-04-10 18:49:56.185977 Epoch 29  	Train Loss = 13.00430 Val Loss = 13.37181
2023-04-10 18:50:05.696979 Epoch 30  	Train Loss = 12.99881 Val Loss = 13.55152
2023-04-10 18:50:15.126573 Epoch 31  	Train Loss = 12.96904 Val Loss = 13.39329
2023-04-10 18:50:24.273677 Epoch 32  	Train Loss = 12.95495 Val Loss = 13.42233
2023-04-10 18:50:33.632990 Epoch 33  	Train Loss = 12.95175 Val Loss = 13.52932
2023-04-10 18:50:42.674195 Epoch 34  	Train Loss = 12.95284 Val Loss = 13.39981
2023-04-10 18:50:51.637878 Epoch 35  	Train Loss = 12.92839 Val Loss = 13.41898
2023-04-10 18:51:00.835738 Epoch 36  	Train Loss = 12.95045 Val Loss = 13.47253
2023-04-10 18:51:10.125565 Epoch 37  	Train Loss = 12.92646 Val Loss = 13.51807
2023-04-10 18:51:19.252832 Epoch 38  	Train Loss = 12.92054 Val Loss = 13.43381
2023-04-10 18:51:28.728324 Epoch 39  	Train Loss = 12.88720 Val Loss = 13.43846
2023-04-10 18:51:37.714124 Epoch 40  	Train Loss = 12.90697 Val Loss = 13.31665
2023-04-10 18:51:46.933854 Epoch 41  	Train Loss = 12.89831 Val Loss = 13.53851
2023-04-10 18:51:56.229273 Epoch 42  	Train Loss = 12.88866 Val Loss = 13.38765
2023-04-10 18:52:05.417325 Epoch 43  	Train Loss = 12.87763 Val Loss = 13.30085
2023-04-10 18:52:14.723109 Epoch 44  	Train Loss = 12.85974 Val Loss = 13.35414
2023-04-10 18:52:23.595244 Epoch 45  	Train Loss = 12.88847 Val Loss = 13.43846
2023-04-10 18:52:32.983263 Epoch 46  	Train Loss = 12.85323 Val Loss = 13.58991
2023-04-10 18:52:42.291502 Epoch 47  	Train Loss = 12.85426 Val Loss = 13.34869
2023-04-10 18:52:51.375133 Epoch 48  	Train Loss = 12.84453 Val Loss = 13.29891
2023-04-10 18:53:00.796577 Epoch 49  	Train Loss = 12.84750 Val Loss = 13.30266
2023-04-10 18:53:10.183003 Epoch 50  	Train Loss = 12.82201 Val Loss = 13.36258
2023-04-10 18:53:19.562483 Epoch 51  	Train Loss = 12.69497 Val Loss = 13.33866
2023-04-10 18:53:28.593194 Epoch 52  	Train Loss = 12.68791 Val Loss = 13.23930
2023-04-10 18:53:37.619754 Epoch 53  	Train Loss = 12.68160 Val Loss = 13.25934
2023-04-10 18:53:46.843663 Epoch 54  	Train Loss = 12.69112 Val Loss = 13.34138
2023-04-10 18:53:56.362534 Epoch 55  	Train Loss = 12.68123 Val Loss = 13.25972
2023-04-10 18:54:05.703226 Epoch 56  	Train Loss = 12.68551 Val Loss = 13.29059
2023-04-10 18:54:14.811137 Epoch 57  	Train Loss = 12.68054 Val Loss = 13.32563
2023-04-10 18:54:24.292928 Epoch 58  	Train Loss = 12.67669 Val Loss = 13.16695
2023-04-10 18:54:33.539107 Epoch 59  	Train Loss = 12.67741 Val Loss = 13.24740
2023-04-10 18:54:42.954200 Epoch 60  	Train Loss = 12.66897 Val Loss = 13.24766
2023-04-10 18:54:52.161260 Epoch 61  	Train Loss = 12.67119 Val Loss = 13.16074
2023-04-10 18:55:01.695454 Epoch 62  	Train Loss = 12.67239 Val Loss = 13.24153
2023-04-10 18:55:11.023977 Epoch 63  	Train Loss = 12.66595 Val Loss = 13.32322
2023-04-10 18:55:20.462239 Epoch 64  	Train Loss = 12.66086 Val Loss = 13.15932
2023-04-10 18:55:26.780818 Epoch 65  	Train Loss = 12.66371 Val Loss = 13.29875
2023-04-10 18:55:36.034482 Epoch 66  	Train Loss = 12.65586 Val Loss = 13.36380
2023-04-10 18:55:44.407232 Epoch 67  	Train Loss = 12.65344 Val Loss = 13.17638
2023-04-10 18:55:52.149072 Epoch 68  	Train Loss = 12.65622 Val Loss = 13.19205
2023-04-10 18:56:00.003583 Epoch 69  	Train Loss = 12.64603 Val Loss = 13.25823
2023-04-10 18:56:07.900650 Epoch 70  	Train Loss = 12.65546 Val Loss = 13.26416
2023-04-10 18:56:15.724191 Epoch 71  	Train Loss = 12.64238 Val Loss = 13.23836
2023-04-10 18:56:23.596120 Epoch 72  	Train Loss = 12.65183 Val Loss = 13.20834
2023-04-10 18:56:31.420878 Epoch 73  	Train Loss = 12.64516 Val Loss = 13.33880
2023-04-10 18:56:39.134819 Epoch 74  	Train Loss = 12.63987 Val Loss = 13.23584
2023-04-10 18:56:43.208235 Epoch 75  	Train Loss = 12.64226 Val Loss = 13.29079
2023-04-10 18:56:48.467729 Epoch 76  	Train Loss = 12.64213 Val Loss = 13.19822
2023-04-10 18:56:56.184519 Epoch 77  	Train Loss = 12.63301 Val Loss = 13.27245
2023-04-10 18:57:04.279644 Epoch 78  	Train Loss = 12.62674 Val Loss = 13.27427
2023-04-10 18:57:11.890373 Epoch 79  	Train Loss = 12.63299 Val Loss = 13.24214
2023-04-10 18:57:19.831174 Epoch 80  	Train Loss = 12.62889 Val Loss = 13.30089
2023-04-10 18:57:27.686804 Epoch 81  	Train Loss = 12.56258 Val Loss = 13.24792
2023-04-10 18:57:35.522456 Epoch 82  	Train Loss = 12.56136 Val Loss = 13.20517
2023-04-10 18:57:43.183702 Epoch 83  	Train Loss = 12.55855 Val Loss = 13.14629
2023-04-10 18:57:50.766179 Epoch 84  	Train Loss = 12.55991 Val Loss = 13.25782
2023-04-10 18:57:58.661408 Epoch 85  	Train Loss = 12.55788 Val Loss = 13.21482
2023-04-10 18:58:06.318038 Epoch 86  	Train Loss = 12.55718 Val Loss = 13.18372
2023-04-10 18:58:14.153069 Epoch 87  	Train Loss = 12.55883 Val Loss = 13.21175
2023-04-10 18:58:22.152126 Epoch 88  	Train Loss = 12.55511 Val Loss = 13.21307
2023-04-10 18:58:30.088918 Epoch 89  	Train Loss = 12.55369 Val Loss = 13.18557
2023-04-10 18:58:37.918962 Epoch 90  	Train Loss = 12.55351 Val Loss = 13.18136
2023-04-10 18:58:45.943637 Epoch 91  	Train Loss = 12.55050 Val Loss = 13.21942
2023-04-10 18:58:53.966502 Epoch 92  	Train Loss = 12.55169 Val Loss = 13.18108
2023-04-10 18:59:01.925033 Epoch 93  	Train Loss = 12.55026 Val Loss = 13.14415
2023-04-10 18:59:09.747971 Epoch 94  	Train Loss = 12.54698 Val Loss = 13.20808
2023-04-10 18:59:17.605706 Epoch 95  	Train Loss = 12.54743 Val Loss = 13.19513
2023-04-10 18:59:25.500450 Epoch 96  	Train Loss = 12.55003 Val Loss = 13.26701
2023-04-10 18:59:33.263857 Epoch 97  	Train Loss = 12.54523 Val Loss = 13.18238
2023-04-10 18:59:40.826454 Epoch 98  	Train Loss = 12.54705 Val Loss = 13.18603
2023-04-10 18:59:48.688855 Epoch 99  	Train Loss = 12.54192 Val Loss = 13.22109
2023-04-10 18:59:56.478300 Epoch 100  	Train Loss = 12.54191 Val Loss = 13.24849
2023-04-10 19:00:04.380342 Epoch 101  	Train Loss = 12.54220 Val Loss = 13.16808
2023-04-10 19:00:12.104765 Epoch 102  	Train Loss = 12.54205 Val Loss = 13.19917
2023-04-10 19:00:20.143976 Epoch 103  	Train Loss = 12.54122 Val Loss = 13.20596
2023-04-10 19:00:27.828989 Epoch 104  	Train Loss = 12.54080 Val Loss = 13.18298
2023-04-10 19:00:35.704343 Epoch 105  	Train Loss = 12.54010 Val Loss = 13.20265
2023-04-10 19:00:43.631492 Epoch 106  	Train Loss = 12.54038 Val Loss = 13.18615
2023-04-10 19:00:51.524295 Epoch 107  	Train Loss = 12.54034 Val Loss = 13.19426
2023-04-10 19:00:59.542184 Epoch 108  	Train Loss = 12.53455 Val Loss = 13.22664
2023-04-10 19:01:07.309840 Epoch 109  	Train Loss = 12.53301 Val Loss = 13.24570
2023-04-10 19:01:15.113449 Epoch 110  	Train Loss = 12.53539 Val Loss = 13.18158
2023-04-10 19:01:23.041296 Epoch 111  	Train Loss = 12.53475 Val Loss = 13.11949
2023-04-10 19:01:31.003133 Epoch 112  	Train Loss = 12.53419 Val Loss = 13.21652
2023-04-10 19:01:38.797957 Epoch 113  	Train Loss = 12.53100 Val Loss = 13.18605
2023-04-10 19:01:46.363810 Epoch 114  	Train Loss = 12.53275 Val Loss = 13.16393
2023-04-10 19:01:53.939585 Epoch 115  	Train Loss = 12.53311 Val Loss = 13.18081
2023-04-10 19:02:01.821571 Epoch 116  	Train Loss = 12.52905 Val Loss = 13.18615
2023-04-10 19:02:09.982226 Epoch 117  	Train Loss = 12.52895 Val Loss = 13.23275
2023-04-10 19:02:17.935420 Epoch 118  	Train Loss = 12.52845 Val Loss = 13.24769
2023-04-10 19:02:25.824726 Epoch 119  	Train Loss = 12.52771 Val Loss = 13.23714
2023-04-10 19:02:33.692427 Epoch 120  	Train Loss = 12.52542 Val Loss = 13.18194
2023-04-10 19:02:41.565740 Epoch 121  	Train Loss = 12.52226 Val Loss = 13.18311
2023-04-10 19:02:49.673292 Epoch 122  	Train Loss = 12.52696 Val Loss = 13.19569
2023-04-10 19:02:57.621581 Epoch 123  	Train Loss = 12.52448 Val Loss = 13.21511
2023-04-10 19:03:05.310598 Epoch 124  	Train Loss = 12.52407 Val Loss = 13.18675
2023-04-10 19:03:13.167660 Epoch 125  	Train Loss = 12.52434 Val Loss = 13.16350
2023-04-10 19:03:20.973179 Epoch 126  	Train Loss = 12.52086 Val Loss = 13.22160
2023-04-10 19:03:28.887661 Epoch 127  	Train Loss = 12.52029 Val Loss = 13.14975
2023-04-10 19:03:36.599444 Epoch 128  	Train Loss = 12.51968 Val Loss = 13.21886
2023-04-10 19:03:44.300102 Epoch 129  	Train Loss = 12.51889 Val Loss = 13.21407
2023-04-10 19:03:49.936899 Epoch 130  	Train Loss = 12.51999 Val Loss = 13.16237
2023-04-10 19:03:53.944890 Epoch 131  	Train Loss = 12.51936 Val Loss = 13.17959
2023-04-10 19:04:01.327415 Epoch 132  	Train Loss = 12.51738 Val Loss = 13.18826
2023-04-10 19:04:08.842803 Epoch 133  	Train Loss = 12.51467 Val Loss = 13.18307
2023-04-10 19:04:16.844144 Epoch 134  	Train Loss = 12.51811 Val Loss = 13.19891
2023-04-10 19:04:24.528980 Epoch 135  	Train Loss = 12.51774 Val Loss = 13.17638
2023-04-10 19:04:32.500615 Epoch 136  	Train Loss = 12.51516 Val Loss = 13.24925
2023-04-10 19:04:40.643469 Epoch 137  	Train Loss = 12.51566 Val Loss = 13.15590
2023-04-10 19:04:48.756284 Epoch 138  	Train Loss = 12.51589 Val Loss = 13.22053
2023-04-10 19:04:56.593577 Epoch 139  	Train Loss = 12.51431 Val Loss = 13.23108
2023-04-10 19:05:04.547995 Epoch 140  	Train Loss = 12.51326 Val Loss = 13.24406
2023-04-10 19:05:12.559799 Epoch 141  	Train Loss = 12.51560 Val Loss = 13.16290
Early stopping at epoch: 141
Best at epoch 111:
Train Loss = 12.53475
Train RMSE = 20.84872, MAE = 12.72007, MAPE = 11.92927
Val Loss = 13.11949
Val RMSE = 21.91842, MAE = 13.67819, MAPE = 13.15332
--------- Test ---------
All Steps RMSE = 26.22986, MAE = 15.30134, MAPE = 16.11142
Step 1 RMSE = 19.48405, MAE = 12.39661, MAPE = 13.11227
Step 2 RMSE = 21.77275, MAE = 13.22833, MAPE = 14.27388
Step 3 RMSE = 23.58082, MAE = 13.92099, MAPE = 14.71457
Step 4 RMSE = 24.58734, MAE = 14.45478, MAPE = 15.20394
Step 5 RMSE = 25.42369, MAE = 14.88185, MAPE = 15.60736
Step 6 RMSE = 26.21358, MAE = 15.32482, MAPE = 16.13592
Step 7 RMSE = 27.15876, MAE = 15.72172, MAPE = 16.45240
Step 8 RMSE = 27.88062, MAE = 16.12975, MAPE = 16.93511
Step 9 RMSE = 28.41285, MAE = 16.44318, MAPE = 17.22286
Step 10 RMSE = 28.78853, MAE = 16.72335, MAPE = 17.58430
Step 11 RMSE = 29.50048, MAE = 17.02037, MAPE = 17.81316
Step 12 RMSE = 29.78255, MAE = 17.37029, MAPE = 18.28106
Inference time: 0.57 s
