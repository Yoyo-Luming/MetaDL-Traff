PEMS07
Trainset:	x-(16921, 12, 883, 3)	y-(16921, 12, 883, 1)
Valset:  	x-(5640, 12, 883, 3)  	y-(5640, 12, 883, 1)
Testset:	x-(5640, 12, 883, 3)	y-(5640, 12, 883, 1)

--------- STID ---------
{
    "num_nodes": 883,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.002,
    "weight_decay": 0.0001,
    "milestones": [
        1,
        50,
        80
    ],
    "lr_decay_rate": 0.5,
    "batch_size": 32,
    "max_epochs": 200,
    "early_stop": 30,
    "use_cl": false,
    "model_args": {
        "num_nodes": 883,
        "input_len": 12,
        "output_len": 12,
        "input_dim": 3,
        "embed_dim": 32,
        "node_dim": 32,
        "temp_dim_tid": 32,
        "temp_dim_diw": 32,
        "time_of_day_size": 288,
        "day_of_week_size": 7,
        "if_node": true,
        "if_time_in_day": true,
        "if_day_in_week": true,
        "num_layer": 3
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
STID                                     --                        --
├─Conv2d: 1-1                            [32, 32, 883, 1]          1,184
├─Sequential: 1-2                        [32, 128, 883, 1]         --
│    └─MultiLayerPerceptron: 2-1         [32, 128, 883, 1]         --
│    │    └─Conv2d: 3-1                  [32, 128, 883, 1]         16,512
│    │    └─ReLU: 3-2                    [32, 128, 883, 1]         --
│    │    └─Dropout: 3-3                 [32, 128, 883, 1]         --
│    │    └─Conv2d: 3-4                  [32, 128, 883, 1]         16,512
│    └─MultiLayerPerceptron: 2-2         [32, 128, 883, 1]         --
│    │    └─Conv2d: 3-5                  [32, 128, 883, 1]         16,512
│    │    └─ReLU: 3-6                    [32, 128, 883, 1]         --
│    │    └─Dropout: 3-7                 [32, 128, 883, 1]         --
│    │    └─Conv2d: 3-8                  [32, 128, 883, 1]         16,512
│    └─MultiLayerPerceptron: 2-3         [32, 128, 883, 1]         --
│    │    └─Conv2d: 3-9                  [32, 128, 883, 1]         16,512
│    │    └─ReLU: 3-10                   [32, 128, 883, 1]         --
│    │    └─Dropout: 3-11                [32, 128, 883, 1]         --
│    │    └─Conv2d: 3-12                 [32, 128, 883, 1]         16,512
├─Conv2d: 1-3                            [32, 12, 883, 1]          1,548
==========================================================================================
Total params: 101,804
Trainable params: 101,804
Non-trainable params: 0
Total mult-adds (G): 2.88
==========================================================================================
Input size (MB): 4.07
Forward/backward pass size (MB): 183.55
Params size (MB): 0.41
Estimated Total Size (MB): 188.03
==========================================================================================

Loss: HuberLoss

2023-04-10 18:46:43.784804 Epoch 1  	Train Loss = 29.44452 Val Loss = 22.96124
2023-04-10 18:47:01.059678 Epoch 2  	Train Loss = 22.44388 Val Loss = 21.66967
2023-04-10 18:47:18.199799 Epoch 3  	Train Loss = 21.62107 Val Loss = 21.41070
2023-04-10 18:47:35.530427 Epoch 4  	Train Loss = 21.10297 Val Loss = 21.03428
2023-04-10 18:47:52.417948 Epoch 5  	Train Loss = 20.83217 Val Loss = 21.29056
2023-04-10 18:48:09.786830 Epoch 6  	Train Loss = 20.52376 Val Loss = 20.81962
2023-04-10 18:48:26.581672 Epoch 7  	Train Loss = 20.25659 Val Loss = 20.33413
2023-04-10 18:48:43.629838 Epoch 8  	Train Loss = 20.10680 Val Loss = 20.50298
2023-04-10 18:49:00.817351 Epoch 9  	Train Loss = 20.02799 Val Loss = 20.15003
2023-04-10 18:49:18.032185 Epoch 10  	Train Loss = 19.94289 Val Loss = 20.15068
2023-04-10 18:49:35.228063 Epoch 11  	Train Loss = 19.79276 Val Loss = 20.02962
2023-04-10 18:49:52.667078 Epoch 12  	Train Loss = 19.72724 Val Loss = 19.99897
2023-04-10 18:50:10.239352 Epoch 13  	Train Loss = 19.65092 Val Loss = 19.89989
2023-04-10 18:50:27.166971 Epoch 14  	Train Loss = 19.57772 Val Loss = 19.77447
2023-04-10 18:50:44.580205 Epoch 15  	Train Loss = 19.52888 Val Loss = 19.74401
2023-04-10 18:51:01.918006 Epoch 16  	Train Loss = 19.49232 Val Loss = 20.01093
2023-04-10 18:51:19.140629 Epoch 17  	Train Loss = 19.44023 Val Loss = 19.97207
2023-04-10 18:51:36.121203 Epoch 18  	Train Loss = 19.40046 Val Loss = 19.86644
2023-04-10 18:51:53.440089 Epoch 19  	Train Loss = 19.42139 Val Loss = 19.61957
2023-04-10 18:52:10.484551 Epoch 20  	Train Loss = 19.32784 Val Loss = 19.67274
2023-04-10 18:52:27.940196 Epoch 21  	Train Loss = 19.26351 Val Loss = 20.00077
2023-04-10 18:52:45.213867 Epoch 22  	Train Loss = 19.30293 Val Loss = 19.80298
2023-04-10 18:53:02.206623 Epoch 23  	Train Loss = 19.23289 Val Loss = 19.54444
2023-04-10 18:53:19.875893 Epoch 24  	Train Loss = 19.24263 Val Loss = 19.52980
2023-04-10 18:53:36.918426 Epoch 25  	Train Loss = 19.19524 Val Loss = 19.51014
2023-04-10 18:53:54.175747 Epoch 26  	Train Loss = 19.17145 Val Loss = 19.51865
2023-04-10 18:54:11.039180 Epoch 27  	Train Loss = 19.14701 Val Loss = 19.67284
2023-04-10 18:54:28.430640 Epoch 28  	Train Loss = 19.14991 Val Loss = 19.78455
2023-04-10 18:54:45.642832 Epoch 29  	Train Loss = 19.14170 Val Loss = 19.47202
2023-04-10 18:55:03.055883 Epoch 30  	Train Loss = 19.09645 Val Loss = 19.55820
2023-04-10 18:55:20.236119 Epoch 31  	Train Loss = 19.04758 Val Loss = 19.44654
2023-04-10 18:55:37.475342 Epoch 32  	Train Loss = 19.05809 Val Loss = 19.49877
2023-04-10 18:55:54.983914 Epoch 33  	Train Loss = 19.10184 Val Loss = 19.38736
2023-04-10 18:56:12.154375 Epoch 34  	Train Loss = 19.04874 Val Loss = 19.47942
2023-04-10 18:56:29.491684 Epoch 35  	Train Loss = 19.02174 Val Loss = 19.60973
2023-04-10 18:56:46.453832 Epoch 36  	Train Loss = 19.00141 Val Loss = 19.47189
2023-04-10 18:57:03.521005 Epoch 37  	Train Loss = 18.98634 Val Loss = 19.56602
2023-04-10 18:57:20.786070 Epoch 38  	Train Loss = 18.97511 Val Loss = 19.42952
2023-04-10 18:57:38.392604 Epoch 39  	Train Loss = 18.96834 Val Loss = 19.37703
2023-04-10 18:57:55.340168 Epoch 40  	Train Loss = 18.97754 Val Loss = 19.62604
2023-04-10 18:58:12.483909 Epoch 41  	Train Loss = 18.95106 Val Loss = 19.46279
2023-04-10 18:58:29.631862 Epoch 42  	Train Loss = 18.97115 Val Loss = 19.25142
2023-04-10 18:58:47.559867 Epoch 43  	Train Loss = 18.94833 Val Loss = 19.39725
2023-04-10 18:59:04.929371 Epoch 44  	Train Loss = 18.91624 Val Loss = 19.46264
2023-04-10 18:59:21.989393 Epoch 45  	Train Loss = 18.91382 Val Loss = 19.38659
2023-04-10 18:59:39.541692 Epoch 46  	Train Loss = 18.90815 Val Loss = 19.34504
2023-04-10 18:59:56.879536 Epoch 47  	Train Loss = 18.90040 Val Loss = 19.30048
2023-04-10 19:00:13.978007 Epoch 48  	Train Loss = 18.94409 Val Loss = 19.62157
2023-04-10 19:00:31.190007 Epoch 49  	Train Loss = 18.86665 Val Loss = 19.56038
2023-04-10 19:00:48.439504 Epoch 50  	Train Loss = 18.89768 Val Loss = 19.33250
2023-04-10 19:01:05.644383 Epoch 51  	Train Loss = 18.68514 Val Loss = 19.26757
2023-04-10 19:01:23.226438 Epoch 52  	Train Loss = 18.68560 Val Loss = 19.22218
2023-04-10 19:01:40.243524 Epoch 53  	Train Loss = 18.68703 Val Loss = 19.23295
2023-04-10 19:01:57.414049 Epoch 54  	Train Loss = 18.68782 Val Loss = 19.31617
2023-04-10 19:02:14.403223 Epoch 55  	Train Loss = 18.68301 Val Loss = 19.18875
2023-04-10 19:02:31.686591 Epoch 56  	Train Loss = 18.67316 Val Loss = 19.25567
2023-04-10 19:02:48.760967 Epoch 57  	Train Loss = 18.67408 Val Loss = 19.24195
2023-04-10 19:03:05.886804 Epoch 58  	Train Loss = 18.67415 Val Loss = 19.34605
2023-04-10 19:03:23.304081 Epoch 59  	Train Loss = 18.67169 Val Loss = 19.33135
2023-04-10 19:03:40.206213 Epoch 60  	Train Loss = 18.66286 Val Loss = 19.16538
2023-04-10 19:03:57.472523 Epoch 61  	Train Loss = 18.66746 Val Loss = 19.35493
2023-04-10 19:04:14.524370 Epoch 62  	Train Loss = 18.65419 Val Loss = 19.27734
2023-04-10 19:04:31.788273 Epoch 63  	Train Loss = 18.65067 Val Loss = 19.20818
2023-04-10 19:04:48.831503 Epoch 64  	Train Loss = 18.64755 Val Loss = 19.19852
2023-04-10 19:05:06.433297 Epoch 65  	Train Loss = 18.65174 Val Loss = 19.26866
2023-04-10 19:05:23.416578 Epoch 66  	Train Loss = 18.63272 Val Loss = 19.26732
2023-04-10 19:05:40.715308 Epoch 67  	Train Loss = 18.63928 Val Loss = 19.24918
2023-04-10 19:05:58.094167 Epoch 68  	Train Loss = 18.62560 Val Loss = 19.18197
2023-04-10 19:06:15.240393 Epoch 69  	Train Loss = 18.64308 Val Loss = 19.24220
2023-04-10 19:06:32.479082 Epoch 70  	Train Loss = 18.62602 Val Loss = 19.19398
2023-04-10 19:06:49.434407 Epoch 71  	Train Loss = 18.62639 Val Loss = 19.36163
2023-04-10 19:07:06.583919 Epoch 72  	Train Loss = 18.62196 Val Loss = 19.21227
2023-04-10 19:07:23.630112 Epoch 73  	Train Loss = 18.61930 Val Loss = 19.21002
2023-04-10 19:07:41.336112 Epoch 74  	Train Loss = 18.61831 Val Loss = 19.21750
2023-04-10 19:07:58.415276 Epoch 75  	Train Loss = 18.61052 Val Loss = 19.17768
2023-04-10 19:08:15.657010 Epoch 76  	Train Loss = 18.61371 Val Loss = 19.20342
2023-04-10 19:08:32.758467 Epoch 77  	Train Loss = 18.60797 Val Loss = 19.29636
2023-04-10 19:08:50.176136 Epoch 78  	Train Loss = 18.61315 Val Loss = 19.23436
2023-04-10 19:09:07.008623 Epoch 79  	Train Loss = 18.59657 Val Loss = 19.32188
2023-04-10 19:09:24.288746 Epoch 80  	Train Loss = 18.60998 Val Loss = 19.21647
2023-04-10 19:09:41.286101 Epoch 81  	Train Loss = 18.52209 Val Loss = 19.18191
2023-04-10 19:09:58.809703 Epoch 82  	Train Loss = 18.51241 Val Loss = 19.20057
2023-04-10 19:10:15.635608 Epoch 83  	Train Loss = 18.51621 Val Loss = 19.08587
2023-04-10 19:10:32.924601 Epoch 84  	Train Loss = 18.51462 Val Loss = 19.11558
2023-04-10 19:10:49.806904 Epoch 85  	Train Loss = 18.51162 Val Loss = 19.15545
2023-04-10 19:11:06.856989 Epoch 86  	Train Loss = 18.51412 Val Loss = 19.23863
2023-04-10 19:11:24.024898 Epoch 87  	Train Loss = 18.51200 Val Loss = 19.13273
2023-04-10 19:11:41.024187 Epoch 88  	Train Loss = 18.51132 Val Loss = 19.18656
2023-04-10 19:11:58.024504 Epoch 89  	Train Loss = 18.50974 Val Loss = 19.20040
2023-04-10 19:12:15.489120 Epoch 90  	Train Loss = 18.51215 Val Loss = 19.17087
2023-04-10 19:12:33.189674 Epoch 91  	Train Loss = 18.50625 Val Loss = 19.14406
2023-04-10 19:12:50.149983 Epoch 92  	Train Loss = 18.50721 Val Loss = 19.15028
2023-04-10 19:13:07.545118 Epoch 93  	Train Loss = 18.50749 Val Loss = 19.18197
2023-04-10 19:13:24.654715 Epoch 94  	Train Loss = 18.50436 Val Loss = 19.13657
2023-04-10 19:13:41.941630 Epoch 95  	Train Loss = 18.50427 Val Loss = 19.13282
2023-04-10 19:13:59.056892 Epoch 96  	Train Loss = 18.49671 Val Loss = 19.19565
2023-04-10 19:14:16.384485 Epoch 97  	Train Loss = 18.49821 Val Loss = 19.19490
2023-04-10 19:14:33.598919 Epoch 98  	Train Loss = 18.50309 Val Loss = 19.17512
2023-04-10 19:14:50.813791 Epoch 99  	Train Loss = 18.49858 Val Loss = 19.13848
2023-04-10 19:15:08.363306 Epoch 100  	Train Loss = 18.49555 Val Loss = 19.14224
2023-04-10 19:15:25.466936 Epoch 101  	Train Loss = 18.49579 Val Loss = 19.15043
2023-04-10 19:15:43.049980 Epoch 102  	Train Loss = 18.49423 Val Loss = 19.16740
2023-04-10 19:15:59.713179 Epoch 103  	Train Loss = 18.49195 Val Loss = 19.14301
2023-04-10 19:16:17.178671 Epoch 104  	Train Loss = 18.49337 Val Loss = 19.16640
2023-04-10 19:16:34.160950 Epoch 105  	Train Loss = 18.49072 Val Loss = 19.17029
2023-04-10 19:16:51.341347 Epoch 106  	Train Loss = 18.48894 Val Loss = 19.11399
2023-04-10 19:17:08.650329 Epoch 107  	Train Loss = 18.48741 Val Loss = 19.17574
2023-04-10 19:17:25.660542 Epoch 108  	Train Loss = 18.48639 Val Loss = 19.15685
2023-04-10 19:17:43.283629 Epoch 109  	Train Loss = 18.48301 Val Loss = 19.12092
2023-04-10 19:18:00.260902 Epoch 110  	Train Loss = 18.48577 Val Loss = 19.13204
2023-04-10 19:18:17.970710 Epoch 111  	Train Loss = 18.48533 Val Loss = 19.11566
2023-04-10 19:18:35.426994 Epoch 112  	Train Loss = 18.48522 Val Loss = 19.10430
2023-04-10 19:18:52.394713 Epoch 113  	Train Loss = 18.48286 Val Loss = 19.10775
Early stopping at epoch: 113
Best at epoch 83:
Train Loss = 18.51621
Train RMSE = 31.39459, MAE = 18.61845, MAPE = 8.16871
Val Loss = 19.08587
Val RMSE = 33.05313, MAE = 19.62287, MAPE = 8.72308
--------- Test ---------
All Steps RMSE = 32.71697, MAE = 19.59706, MAPE = 8.27736
Step 1 RMSE = 27.15456, MAE = 16.83156, MAPE = 7.06582
Step 2 RMSE = 29.13696, MAE = 17.73906, MAPE = 7.45810
Step 3 RMSE = 30.36360, MAE = 18.36259, MAPE = 7.73338
Step 4 RMSE = 31.31400, MAE = 18.85584, MAPE = 7.93392
Step 5 RMSE = 32.12199, MAE = 19.27493, MAPE = 8.11575
Step 6 RMSE = 32.81453, MAE = 19.65892, MAPE = 8.27590
Step 7 RMSE = 33.43053, MAE = 19.99013, MAPE = 8.41002
Step 8 RMSE = 33.99812, MAE = 20.30569, MAPE = 8.57826
Step 9 RMSE = 34.52404, MAE = 20.60315, MAPE = 8.73461
Step 10 RMSE = 34.99072, MAE = 20.85896, MAPE = 8.85188
Step 11 RMSE = 35.48522, MAE = 21.14793, MAPE = 8.97883
Step 12 RMSE = 36.03130, MAE = 21.53312, MAPE = 9.19083
Inference time: 1.56 s
