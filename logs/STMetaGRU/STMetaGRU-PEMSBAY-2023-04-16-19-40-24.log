PEMSBAY
Trainset:	x-(36465, 12, 325, 3)	y-(36465, 12, 325, 1)
Valset:  	x-(5209, 12, 325, 3)  	y-(5209, 12, 325, 1)
Testset:	x-(10419, 12, 325, 3)	y-(10419, 12, 325, 1)

--------- STMetaGRU ---------
{
    "num_nodes": 325,
    "in_steps": 12,
    "out_steps": 12,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.001,
    "weight_decay": 0,
    "milestones": [
        10,
        40
    ],
    "clip_grad": false,
    "batch_size": 64,
    "max_epochs": 200,
    "use_cl": false,
    "pass_device": true,
    "model_args": {
        "num_nodes": 325,
        "node_emb_file": "../data/PEMSBAY/spatial_embeddings.npz",
        "in_steps": 12,
        "out_steps": 12,
        "input_dim": 1,
        "output_dim": 1,
        "gru_hidden_dim": 32,
        "tod_embedding_dim": 24,
        "dow_embedding_dim": 7,
        "node_embedding_dim": 64,
        "learner_hidden_dim": 128,
        "z_dim": 32,
        "num_layers": 1,
        "seq2seq": false,
        "device": "cuda:0"
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
STMetaGRU                                [64, 12, 325, 1]          20,800
├─Sequential: 1-1                        [64, 325, 32]             --
│    └─Linear: 2-1                       [64, 325, 32]             416
│    └─Tanh: 2-2                         [64, 325, 32]             --
│    └─Linear: 2-3                       [64, 325, 32]             1,056
│    └─Tanh: 2-4                         [64, 325, 32]             --
│    └─Linear: 2-5                       [64, 325, 32]             1,056
├─Sequential: 1-2                        [64, 325, 32]             --
│    └─Linear: 2-6                       [64, 325, 32]             416
│    └─Tanh: 2-7                         [64, 325, 32]             --
│    └─Linear: 2-8                       [64, 325, 32]             1,056
│    └─Tanh: 2-9                         [64, 325, 32]             --
│    └─Linear: 2-10                      [64, 325, 32]             1,056
├─ModuleList: 1-3                        --                        --
│    └─STMetaGRUEncoder: 2-11            [64, 12, 325, 32]         --
│    │    └─Sequential: 3-1              [64, 325, 96]             28,768
│    │    └─Sequential: 3-2              [64, 325, 3072]           412,672
│    │    └─Sequential: 3-3              [64, 325, 96]             28,768
│    │    └─STMetaGRUCell: 3-4           [64, 325, 1, 32]          --
│    │    └─STMetaGRUCell: 3-5           [64, 325, 1, 32]          --
│    │    └─STMetaGRUCell: 3-6           [64, 325, 1, 32]          --
│    │    └─STMetaGRUCell: 3-7           [64, 325, 1, 32]          --
│    │    └─STMetaGRUCell: 3-8           [64, 325, 1, 32]          --
│    │    └─STMetaGRUCell: 3-9           [64, 325, 1, 32]          --
│    │    └─STMetaGRUCell: 3-10          [64, 325, 1, 32]          --
│    │    └─STMetaGRUCell: 3-11          [64, 325, 1, 32]          --
│    │    └─STMetaGRUCell: 3-12          [64, 325, 1, 32]          --
│    │    └─STMetaGRUCell: 3-13          [64, 325, 1, 32]          --
│    │    └─STMetaGRUCell: 3-14          [64, 325, 1, 32]          --
│    │    └─STMetaGRUCell: 3-15          [64, 325, 1, 32]          --
├─Linear: 1-4                            [64, 325, 12]             396
==========================================================================================
Total params: 496,460
Trainable params: 496,460
Non-trainable params: 0
Total mult-adds (M): 30.44
==========================================================================================
Input size (MB): 3.00
Forward/backward pass size (MB): 640.97
Params size (MB): 1.90
Estimated Total Size (MB): 645.87
==========================================================================================

Loss: MaskedMAELoss

2023-04-16 19:41:15.240994 Epoch 1  	Train Loss = 2.12283 Val Loss = 1.96701
2023-04-16 19:42:02.021348 Epoch 2  	Train Loss = 1.74105 Val Loss = 1.86150
2023-04-16 19:42:50.469434 Epoch 3  	Train Loss = 1.67501 Val Loss = 1.81155
2023-04-16 19:43:40.020250 Epoch 4  	Train Loss = 1.64008 Val Loss = 1.76889
2023-04-16 19:44:30.040472 Epoch 5  	Train Loss = 1.62001 Val Loss = 1.77128
2023-04-16 19:45:20.169539 Epoch 6  	Train Loss = 1.60338 Val Loss = 1.74094
2023-04-16 19:46:10.332100 Epoch 7  	Train Loss = 1.58775 Val Loss = 1.73343
2023-04-16 19:47:00.524117 Epoch 8  	Train Loss = 1.57923 Val Loss = 1.73200
2023-04-16 19:47:50.800808 Epoch 9  	Train Loss = 1.56879 Val Loss = 1.72005
2023-04-16 19:48:41.122521 Epoch 10  	Train Loss = 1.55897 Val Loss = 1.71718
2023-04-16 19:49:31.385233 Epoch 11  	Train Loss = 1.53124 Val Loss = 1.68802
2023-04-16 19:50:21.617102 Epoch 12  	Train Loss = 1.52573 Val Loss = 1.68943
2023-04-16 19:51:11.554183 Epoch 13  	Train Loss = 1.52323 Val Loss = 1.68771
2023-04-16 19:52:01.395873 Epoch 14  	Train Loss = 1.52194 Val Loss = 1.68548
2023-04-16 19:52:51.101641 Epoch 15  	Train Loss = 1.51932 Val Loss = 1.68485
2023-04-16 19:53:40.763331 Epoch 16  	Train Loss = 1.51756 Val Loss = 1.68333
2023-04-16 19:54:30.440894 Epoch 17  	Train Loss = 1.51611 Val Loss = 1.68274
2023-04-16 19:55:20.144288 Epoch 18  	Train Loss = 1.51488 Val Loss = 1.68309
2023-04-16 19:56:09.967046 Epoch 19  	Train Loss = 1.51328 Val Loss = 1.67588
2023-04-16 19:56:59.945433 Epoch 20  	Train Loss = 1.51163 Val Loss = 1.68029
2023-04-16 19:57:50.098334 Epoch 21  	Train Loss = 1.51024 Val Loss = 1.68112
2023-04-16 19:58:40.302360 Epoch 22  	Train Loss = 1.50928 Val Loss = 1.68131
2023-04-16 19:59:30.504126 Epoch 23  	Train Loss = 1.50788 Val Loss = 1.68553
2023-04-16 20:00:20.671341 Epoch 24  	Train Loss = 1.50697 Val Loss = 1.67979
2023-04-16 20:01:10.785948 Epoch 25  	Train Loss = 1.50572 Val Loss = 1.68314
2023-04-16 20:02:00.886531 Epoch 26  	Train Loss = 1.50454 Val Loss = 1.67881
2023-04-16 20:02:51.098298 Epoch 27  	Train Loss = 1.50463 Val Loss = 1.67887
2023-04-16 20:03:41.257656 Epoch 28  	Train Loss = 1.50209 Val Loss = 1.67952
2023-04-16 20:04:31.397101 Epoch 29  	Train Loss = 1.50125 Val Loss = 1.68291
Early stopping at epoch: 29
Best at epoch 19:
Train Loss = 1.51328
Train RMSE = 3.39472, MAE = 1.49900, MAPE = 3.28292
Val Loss = 1.67588
Val RMSE = 3.91225, MAE = 1.67007, MAPE = 3.93433
--------- Test ---------
All Steps RMSE = 3.81250, MAE = 1.63534, MAPE = 3.74837
Step 1 RMSE = 1.61593, MAE = 0.88333, MAPE = 1.75945
Step 2 RMSE = 2.31631, MAE = 1.15456, MAPE = 2.38687
Step 3 RMSE = 2.87541, MAE = 1.35071, MAPE = 2.88755
Step 4 RMSE = 3.31124, MAE = 1.49983, MAPE = 3.31015
Step 5 RMSE = 3.65200, MAE = 1.61561, MAPE = 3.64756
Step 6 RMSE = 3.91394, MAE = 1.70742, MAPE = 3.92189
Step 7 RMSE = 4.11565, MAE = 1.78040, MAPE = 4.14822
Step 8 RMSE = 4.27512, MAE = 1.83944, MAPE = 4.32638
Step 9 RMSE = 4.40558, MAE = 1.88765, MAPE = 4.47498
Step 10 RMSE = 4.51701, MAE = 1.92973, MAPE = 4.60046
Step 11 RMSE = 4.61840, MAE = 1.96897, MAPE = 4.70566
Step 12 RMSE = 4.71165, MAE = 2.00645, MAPE = 4.81124
Inference time: 3.26 s
