METRLA
Original data shape (34272, 207)
Trainset:	x-(23967, 12, 207, 1)	y-(23967, 12, 207, 1)
Valset:  	x-(3404, 12, 207, 1)  	y-(3404, 12, 207, 1)
Testset:	x-(6832, 12, 207, 1)	y-(6832, 12, 207, 1)

--------- GCLSTM ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "milestones": [
        80
    ],
    "clip_grad": 5,
    "batch_size": 64,
    "max_epochs": 200,
    "use_cl": true,
    "cl_step_size": 2500,
    "load_npz": false,
    "with_embeddings": false,
    "pass_device": true,
    "model_args": {
        "num_nodes": 207,
        "input_dim": 1,
        "output_dim": 1,
        "horizon": 12,
        "rnn_units": 64,
        "num_layers": 1,
        "cheb_k": 3,
        "adj_path": "../data/METRLA/adj_mx.pkl",
        "adj_type": "doubletransition",
        "device": "cuda:0"
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
GCLSTM                                   --                        --
├─Encoder: 1                             --                        --
│    └─ModuleList: 2-1                   --                        --
├─Decoder: 1                             --                        --
│    └─ModuleList: 2-2                   --                        --
├─Encoder: 1-1                           [64, 207, 64]             --
│    └─ModuleList: 2-1                   --                        --
│    │    └─LSTM_Cell: 3-1               [64, 207, 64]             50,176
│    │    └─LSTM_Cell: 3-2               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-3               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-4               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-5               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-6               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-7               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-8               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-9               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-10              [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-11              [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-12              [64, 207, 64]             (recursive)
├─Decoder: 1-2                           [64, 207, 64]             --
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-13              [64, 207, 64]             50,176
├─Sequential: 1-3                        [64, 207, 1]              --
│    └─Linear: 2-3                       [64, 207, 1]              65
├─Decoder: 1-4                           [64, 207, 64]             (recursive)
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-14              [64, 207, 64]             (recursive)
├─Sequential: 1-5                        [64, 207, 1]              (recursive)
│    └─Linear: 2-4                       [64, 207, 1]              (recursive)
├─Decoder: 1-6                           [64, 207, 64]             (recursive)
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-15              [64, 207, 64]             (recursive)
├─Sequential: 1-7                        [64, 207, 1]              (recursive)
│    └─Linear: 2-5                       [64, 207, 1]              (recursive)
├─Decoder: 1-8                           [64, 207, 64]             (recursive)
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-16              [64, 207, 64]             (recursive)
├─Sequential: 1-9                        [64, 207, 1]              (recursive)
│    └─Linear: 2-6                       [64, 207, 1]              (recursive)
├─Decoder: 1-10                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-17              [64, 207, 64]             (recursive)
├─Sequential: 1-11                       [64, 207, 1]              (recursive)
│    └─Linear: 2-7                       [64, 207, 1]              (recursive)
├─Decoder: 1-12                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-18              [64, 207, 64]             (recursive)
├─Sequential: 1-13                       [64, 207, 1]              (recursive)
│    └─Linear: 2-8                       [64, 207, 1]              (recursive)
├─Decoder: 1-14                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-19              [64, 207, 64]             (recursive)
├─Sequential: 1-15                       [64, 207, 1]              (recursive)
│    └─Linear: 2-9                       [64, 207, 1]              (recursive)
├─Decoder: 1-16                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-20              [64, 207, 64]             (recursive)
├─Sequential: 1-17                       [64, 207, 1]              (recursive)
│    └─Linear: 2-10                      [64, 207, 1]              (recursive)
├─Decoder: 1-18                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-21              [64, 207, 64]             (recursive)
├─Sequential: 1-19                       [64, 207, 1]              (recursive)
│    └─Linear: 2-11                      [64, 207, 1]              (recursive)
├─Decoder: 1-20                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-22              [64, 207, 64]             (recursive)
├─Sequential: 1-21                       [64, 207, 1]              (recursive)
│    └─Linear: 2-12                      [64, 207, 1]              (recursive)
├─Decoder: 1-22                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-23              [64, 207, 64]             (recursive)
├─Sequential: 1-23                       [64, 207, 1]              (recursive)
│    └─Linear: 2-13                      [64, 207, 1]              (recursive)
├─Decoder: 1-24                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-2                   --                        --
│    │    └─LSTM_Cell: 3-24              [64, 207, 64]             (recursive)
├─Sequential: 1-25                       [64, 207, 1]              (recursive)
│    └─Linear: 2-14                      [64, 207, 1]              (recursive)
==========================================================================================
Total params: 100,417
Trainable params: 100,417
Non-trainable params: 0
Total mult-adds (M): 0.05
==========================================================================================
Input size (MB): 0.64
Forward/backward pass size (MB): 54.37
Params size (MB): 0.40
Estimated Total Size (MB): 55.41
==========================================================================================

Loss: MaskedMAELoss

CL target length = 1
2023-03-25 10:30:39.829243 Epoch 1  	Train Loss = 3.10217 Val Loss = 8.55699
2023-03-25 10:31:01.386575 Epoch 2  	Train Loss = 2.51653 Val Loss = 9.22927
2023-03-25 10:31:22.950962 Epoch 3  	Train Loss = 2.46751 Val Loss = 9.02579
2023-03-25 10:31:44.482545 Epoch 4  	Train Loss = 2.43878 Val Loss = 9.04214
2023-03-25 10:32:06.018572 Epoch 5  	Train Loss = 2.41046 Val Loss = 8.40833
2023-03-25 10:32:27.660109 Epoch 6  	Train Loss = 2.38494 Val Loss = 7.84878
CL target length = 2
2023-03-25 10:32:49.231129 Epoch 7  	Train Loss = 2.42905 Val Loss = 4.71188
2023-03-25 10:33:10.123451 Epoch 8  	Train Loss = 2.51611 Val Loss = 4.67218
2023-03-25 10:33:31.298741 Epoch 9  	Train Loss = 2.50071 Val Loss = 4.65662
2023-03-25 10:33:53.122079 Epoch 10  	Train Loss = 2.49445 Val Loss = 4.66616
2023-03-25 10:34:14.321293 Epoch 11  	Train Loss = 2.48477 Val Loss = 4.51637
2023-03-25 10:34:35.754767 Epoch 12  	Train Loss = 2.47482 Val Loss = 4.43545
2023-03-25 10:34:57.172004 Epoch 13  	Train Loss = 2.47020 Val Loss = 4.31377
CL target length = 3
2023-03-25 10:35:18.617108 Epoch 14  	Train Loss = 2.55961 Val Loss = 4.15497
2023-03-25 10:35:39.506234 Epoch 15  	Train Loss = 2.59463 Val Loss = 4.00273
2023-03-25 10:36:00.872953 Epoch 16  	Train Loss = 2.58848 Val Loss = 3.83539
2023-03-25 10:36:22.234354 Epoch 17  	Train Loss = 2.58296 Val Loss = 3.86091
2023-03-25 10:36:43.400128 Epoch 18  	Train Loss = 2.57737 Val Loss = 3.75229
2023-03-25 10:37:04.711400 Epoch 19  	Train Loss = 2.57426 Val Loss = 3.77499
CL target length = 4
2023-03-25 10:37:25.709042 Epoch 20  	Train Loss = 2.56757 Val Loss = 3.67310
2023-03-25 10:37:46.491988 Epoch 21  	Train Loss = 2.68186 Val Loss = 3.40341
2023-03-25 10:38:07.457020 Epoch 22  	Train Loss = 2.67072 Val Loss = 3.43231
2023-03-25 10:38:28.616382 Epoch 23  	Train Loss = 2.66558 Val Loss = 3.30853
2023-03-25 10:38:49.966687 Epoch 24  	Train Loss = 2.65787 Val Loss = 3.38305
2023-03-25 10:39:11.708525 Epoch 25  	Train Loss = 2.65220 Val Loss = 3.27853
2023-03-25 10:39:32.857535 Epoch 26  	Train Loss = 2.64981 Val Loss = 3.35974
CL target length = 5
2023-03-25 10:39:54.307629 Epoch 27  	Train Loss = 2.67529 Val Loss = 3.18892
2023-03-25 10:40:15.962039 Epoch 28  	Train Loss = 2.73537 Val Loss = 3.13989
2023-03-25 10:40:35.947662 Epoch 29  	Train Loss = 2.72614 Val Loss = 3.12644
2023-03-25 10:40:57.448823 Epoch 30  	Train Loss = 2.71846 Val Loss = 3.08818
2023-03-25 10:41:18.816925 Epoch 31  	Train Loss = 2.71194 Val Loss = 3.08513
2023-03-25 10:41:39.506908 Epoch 32  	Train Loss = 2.70675 Val Loss = 3.13107
2023-03-25 10:42:00.661161 Epoch 33  	Train Loss = 2.70066 Val Loss = 3.06718
CL target length = 6
2023-03-25 10:42:22.679491 Epoch 34  	Train Loss = 2.75073 Val Loss = 3.05515
2023-03-25 10:42:44.354555 Epoch 35  	Train Loss = 2.77383 Val Loss = 3.05008
2023-03-25 10:43:06.536269 Epoch 36  	Train Loss = 2.76319 Val Loss = 3.01006
2023-03-25 10:43:28.297356 Epoch 37  	Train Loss = 2.75528 Val Loss = 3.05067
2023-03-25 10:43:50.661306 Epoch 38  	Train Loss = 2.75043 Val Loss = 3.01296
2023-03-25 10:44:11.686811 Epoch 39  	Train Loss = 2.74405 Val Loss = 3.03795
CL target length = 7
2023-03-25 10:44:32.924407 Epoch 40  	Train Loss = 2.74043 Val Loss = 3.01364
2023-03-25 10:44:54.696443 Epoch 41  	Train Loss = 2.80636 Val Loss = 2.98567
2023-03-25 10:45:15.651265 Epoch 42  	Train Loss = 2.79909 Val Loss = 3.02650
2023-03-25 10:45:37.033879 Epoch 43  	Train Loss = 2.79322 Val Loss = 2.99315
2023-03-25 10:45:58.331960 Epoch 44  	Train Loss = 2.78752 Val Loss = 2.99867
2023-03-25 10:46:19.836761 Epoch 45  	Train Loss = 2.78352 Val Loss = 3.00235
2023-03-25 10:46:41.557491 Epoch 46  	Train Loss = 2.77767 Val Loss = 2.96824
CL target length = 8
2023-03-25 10:47:02.999024 Epoch 47  	Train Loss = 2.79704 Val Loss = 2.98753
2023-03-25 10:47:24.703488 Epoch 48  	Train Loss = 2.83242 Val Loss = 2.95852
2023-03-25 10:47:45.757802 Epoch 49  	Train Loss = 2.82263 Val Loss = 2.96316
2023-03-25 10:48:07.483295 Epoch 50  	Train Loss = 2.81801 Val Loss = 2.95413
2023-03-25 10:48:28.471970 Epoch 51  	Train Loss = 2.81350 Val Loss = 2.94821
2023-03-25 10:48:50.142046 Epoch 52  	Train Loss = 2.80690 Val Loss = 2.94872
2023-03-25 10:49:10.831627 Epoch 53  	Train Loss = 2.80267 Val Loss = 2.94489
CL target length = 9
2023-03-25 10:49:32.067284 Epoch 54  	Train Loss = 2.83656 Val Loss = 2.97032
2023-03-25 10:49:53.072491 Epoch 55  	Train Loss = 2.84908 Val Loss = 2.94097
2023-03-25 10:50:14.148095 Epoch 56  	Train Loss = 2.84258 Val Loss = 2.94783
2023-03-25 10:50:35.431073 Epoch 57  	Train Loss = 2.83802 Val Loss = 2.95603
2023-03-25 10:50:56.679289 Epoch 58  	Train Loss = 2.83335 Val Loss = 2.94560
2023-03-25 10:51:18.359646 Epoch 59  	Train Loss = 2.82539 Val Loss = 2.95259
CL target length = 10
2023-03-25 10:51:38.847425 Epoch 60  	Train Loss = 2.82555 Val Loss = 2.96496
2023-03-25 10:51:59.766766 Epoch 61  	Train Loss = 2.87042 Val Loss = 2.95163
2023-03-25 10:52:20.435915 Epoch 62  	Train Loss = 2.86748 Val Loss = 2.93020
2023-03-25 10:52:41.676882 Epoch 63  	Train Loss = 2.85822 Val Loss = 2.93477
2023-03-25 10:53:03.054761 Epoch 64  	Train Loss = 2.85376 Val Loss = 2.95000
2023-03-25 10:53:24.688020 Epoch 65  	Train Loss = 2.84779 Val Loss = 2.93587
2023-03-25 10:53:45.980173 Epoch 66  	Train Loss = 2.84413 Val Loss = 2.93229
CL target length = 11
2023-03-25 10:54:06.966194 Epoch 67  	Train Loss = 2.85498 Val Loss = 2.94552
2023-03-25 10:54:28.953537 Epoch 68  	Train Loss = 2.88488 Val Loss = 2.92155
2023-03-25 10:54:50.298114 Epoch 69  	Train Loss = 2.87317 Val Loss = 2.93180
2023-03-25 10:55:11.884346 Epoch 70  	Train Loss = 2.87097 Val Loss = 2.94360
2023-03-25 10:55:32.756625 Epoch 71  	Train Loss = 2.86651 Val Loss = 2.91756
2023-03-25 10:55:53.694606 Epoch 72  	Train Loss = 2.86110 Val Loss = 2.94308
2023-03-25 10:56:15.277261 Epoch 73  	Train Loss = 2.85679 Val Loss = 2.93259
CL target length = 12
2023-03-25 10:56:36.036506 Epoch 74  	Train Loss = 2.88416 Val Loss = 2.93379
2023-03-25 10:56:56.820420 Epoch 75  	Train Loss = 2.89173 Val Loss = 2.92051
2023-03-25 10:57:17.985113 Epoch 76  	Train Loss = 2.88795 Val Loss = 2.95242
2023-03-25 10:57:39.972717 Epoch 77  	Train Loss = 2.88109 Val Loss = 2.91643
2023-03-25 10:58:01.107454 Epoch 78  	Train Loss = 2.87568 Val Loss = 2.93302
2023-03-25 10:58:22.249794 Epoch 79  	Train Loss = 2.87591 Val Loss = 2.93533
2023-03-25 10:58:43.483878 Epoch 80  	Train Loss = 2.87088 Val Loss = 2.92334
2023-03-25 10:59:04.770290 Epoch 81  	Train Loss = 2.82427 Val Loss = 2.91285
2023-03-25 10:59:25.773964 Epoch 82  	Train Loss = 2.81623 Val Loss = 2.91655
2023-03-25 10:59:47.463133 Epoch 83  	Train Loss = 2.81545 Val Loss = 2.91426
2023-03-25 11:00:08.835118 Epoch 84  	Train Loss = 2.81320 Val Loss = 2.91123
2023-03-25 11:00:30.100691 Epoch 85  	Train Loss = 2.81296 Val Loss = 2.91381
2023-03-25 11:00:51.832883 Epoch 86  	Train Loss = 2.81149 Val Loss = 2.91725
2023-03-25 11:01:12.664712 Epoch 87  	Train Loss = 2.81008 Val Loss = 2.91884
2023-03-25 11:01:33.623636 Epoch 88  	Train Loss = 2.80920 Val Loss = 2.91941
2023-03-25 11:01:54.637752 Epoch 89  	Train Loss = 2.80854 Val Loss = 2.92119
2023-03-25 11:02:16.313394 Epoch 90  	Train Loss = 2.80731 Val Loss = 2.91828
2023-03-25 11:02:37.746810 Epoch 91  	Train Loss = 2.80667 Val Loss = 2.91889
2023-03-25 11:02:58.999174 Epoch 92  	Train Loss = 2.80509 Val Loss = 2.91835
2023-03-25 11:03:20.599195 Epoch 93  	Train Loss = 2.80382 Val Loss = 2.92058
2023-03-25 11:03:42.214586 Epoch 94  	Train Loss = 2.80403 Val Loss = 2.92385
Early stopping at epoch: 94
Best at epoch 84:
Train Loss = 2.81320
Train RMSE = 5.55963, MAE = 2.80089, MAPE = 7.46277
Val Loss = 2.91123
Val RMSE = 6.26558, MAE = 2.97587, MAPE = 8.43455
--------- Test ---------
All Steps RMSE = 6.72101, MAE = 3.28552, MAPE = 9.22101
Step 1 RMSE = 4.15866, MAE = 2.37685, MAPE = 5.89911
Step 2 RMSE = 5.01589, MAE = 2.67079, MAPE = 6.89365
Step 3 RMSE = 5.58132, MAE = 2.87615, MAPE = 7.68427
Step 4 RMSE = 6.04260, MAE = 3.04752, MAPE = 8.31805
Step 5 RMSE = 6.43491, MAE = 3.19320, MAPE = 8.85623
Step 6 RMSE = 6.77068, MAE = 3.32032, MAPE = 9.33444
Step 7 RMSE = 7.05115, MAE = 3.42931, MAPE = 9.75006
Step 8 RMSE = 7.29192, MAE = 3.52886, MAPE = 10.12369
Step 9 RMSE = 7.50107, MAE = 3.61987, MAPE = 10.46841
Step 10 RMSE = 7.69142, MAE = 3.70505, MAPE = 10.79468
Step 11 RMSE = 7.86447, MAE = 3.78738, MAPE = 11.10628
Step 12 RMSE = 8.03327, MAE = 3.87105, MAPE = 11.42355
