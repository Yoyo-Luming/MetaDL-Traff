METRLA
Trainset:	x-(23974, 12, 207, 1)	y-(23974, 12, 207, 1)
Valset:  	x-(3425, 12, 207, 1)  	y-(3425, 12, 207, 1)
Testset:	x-(6850, 12, 207, 1)	y-(6850, 12, 207, 1)

--------- GCLSTM ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "lr": 0.001,
    "weight_decay": 0,
    "milestones": [
        12,
        50
    ],
    "clip_grad": 0,
    "batch_size": 64,
    "max_epochs": 200,
    "use_cl": false,
    "cl_step_size": 2500,
    "pass_device": true,
    "model_args": {
        "num_nodes": 207,
        "input_dim": 1,
        "output_dim": 1,
        "horizon": 12,
        "rnn_units": 64,
        "num_layers": 1,
        "cheb_k": 3,
        "adj_path": "../data/METRLA/adj_mx.pkl",
        "adj_type": "doubletransition",
        "device": "cuda:0"
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
GCLSTM                                   [64, 12, 207, 1]          --
├─Encoder: 1-1                           [64, 207, 64]             --
│    └─ModuleList: 2-1                   --                        --
│    │    └─LSTM_Cell: 3-1               [64, 207, 64]             100,096
│    │    └─LSTM_Cell: 3-2               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-3               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-4               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-5               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-6               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-7               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-8               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-9               [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-10              [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-11              [64, 207, 64]             (recursive)
│    │    └─LSTM_Cell: 3-12              [64, 207, 64]             (recursive)
├─Decoder: 1-2                           [64, 207, 64]             --
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-13              [64, 207, 64]             100,096
├─Sequential: 1-3                        [64, 207, 1]              --
│    └─Linear: 2-3                       [64, 207, 1]              65
├─Decoder: 1-4                           [64, 207, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-14              [64, 207, 64]             (recursive)
├─Sequential: 1-5                        [64, 207, 1]              (recursive)
│    └─Linear: 2-5                       [64, 207, 1]              (recursive)
├─Decoder: 1-6                           [64, 207, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-15              [64, 207, 64]             (recursive)
├─Sequential: 1-7                        [64, 207, 1]              (recursive)
│    └─Linear: 2-7                       [64, 207, 1]              (recursive)
├─Decoder: 1-8                           [64, 207, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-16              [64, 207, 64]             (recursive)
├─Sequential: 1-9                        [64, 207, 1]              (recursive)
│    └─Linear: 2-9                       [64, 207, 1]              (recursive)
├─Decoder: 1-10                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-17              [64, 207, 64]             (recursive)
├─Sequential: 1-11                       [64, 207, 1]              (recursive)
│    └─Linear: 2-11                      [64, 207, 1]              (recursive)
├─Decoder: 1-12                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-18              [64, 207, 64]             (recursive)
├─Sequential: 1-13                       [64, 207, 1]              (recursive)
│    └─Linear: 2-13                      [64, 207, 1]              (recursive)
├─Decoder: 1-14                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-19              [64, 207, 64]             (recursive)
├─Sequential: 1-15                       [64, 207, 1]              (recursive)
│    └─Linear: 2-15                      [64, 207, 1]              (recursive)
├─Decoder: 1-16                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-20              [64, 207, 64]             (recursive)
├─Sequential: 1-17                       [64, 207, 1]              (recursive)
│    └─Linear: 2-17                      [64, 207, 1]              (recursive)
├─Decoder: 1-18                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-21              [64, 207, 64]             (recursive)
├─Sequential: 1-19                       [64, 207, 1]              (recursive)
│    └─Linear: 2-19                      [64, 207, 1]              (recursive)
├─Decoder: 1-20                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-22              [64, 207, 64]             (recursive)
├─Sequential: 1-21                       [64, 207, 1]              (recursive)
│    └─Linear: 2-21                      [64, 207, 1]              (recursive)
├─Decoder: 1-22                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-23              [64, 207, 64]             (recursive)
├─Sequential: 1-23                       [64, 207, 1]              (recursive)
│    └─Linear: 2-23                      [64, 207, 1]              (recursive)
├─Decoder: 1-24                          [64, 207, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTM_Cell: 3-24              [64, 207, 64]             (recursive)
├─Sequential: 1-25                       [64, 207, 1]              (recursive)
│    └─Linear: 2-25                      [64, 207, 1]              (recursive)
==========================================================================================
Total params: 200,257
Trainable params: 200,257
Non-trainable params: 0
Total mult-adds (M): 0.05
==========================================================================================
Input size (MB): 0.64
Forward/backward pass size (MB): 652.44
Params size (MB): 0.80
Estimated Total Size (MB): 653.87
==========================================================================================

Loss: MaskedMAELoss

2023-04-18 17:16:12.939661 Epoch 1  	Train Loss = 4.28441 Val Loss = 3.57136
2023-04-18 17:16:41.356269 Epoch 2  	Train Loss = 3.63031 Val Loss = 3.38468
2023-04-18 17:17:09.107957 Epoch 3  	Train Loss = 3.48995 Val Loss = 3.29033
2023-04-18 17:17:36.893596 Epoch 4  	Train Loss = 3.41012 Val Loss = 3.15028
2023-04-18 17:18:06.410295 Epoch 5  	Train Loss = 3.32844 Val Loss = 3.10519
2023-04-18 17:18:35.015477 Epoch 6  	Train Loss = 3.27600 Val Loss = 3.08011
2023-04-18 17:19:04.199327 Epoch 7  	Train Loss = 3.20959 Val Loss = 3.07137
2023-04-18 17:19:33.389077 Epoch 8  	Train Loss = 3.15929 Val Loss = 2.99180
2023-04-18 17:20:02.569226 Epoch 9  	Train Loss = 3.11171 Val Loss = 2.98363
2023-04-18 17:20:32.162309 Epoch 10  	Train Loss = 3.07827 Val Loss = 2.98084
2023-04-18 17:21:01.461047 Epoch 11  	Train Loss = 3.04533 Val Loss = 2.98986
2023-04-18 17:21:30.965272 Epoch 12  	Train Loss = 3.01939 Val Loss = 2.93653
2023-04-18 17:22:00.995678 Epoch 13  	Train Loss = 2.95078 Val Loss = 2.90888
2023-04-18 17:22:30.685579 Epoch 14  	Train Loss = 2.93970 Val Loss = 2.91345
2023-04-18 17:23:00.058090 Epoch 15  	Train Loss = 2.93579 Val Loss = 2.90533
2023-04-18 17:23:29.617375 Epoch 16  	Train Loss = 2.92962 Val Loss = 2.91710
2023-04-18 17:23:59.024530 Epoch 17  	Train Loss = 2.92547 Val Loss = 2.91017
2023-04-18 17:24:28.233754 Epoch 18  	Train Loss = 2.92062 Val Loss = 2.90638
2023-04-18 17:24:57.500755 Epoch 19  	Train Loss = 2.91658 Val Loss = 2.91340
2023-04-18 17:25:26.674350 Epoch 20  	Train Loss = 2.91125 Val Loss = 2.91191
2023-04-18 17:25:55.811502 Epoch 21  	Train Loss = 2.90736 Val Loss = 2.90996
2023-04-18 17:26:25.045951 Epoch 22  	Train Loss = 2.90347 Val Loss = 2.90424
2023-04-18 17:26:54.381774 Epoch 23  	Train Loss = 2.89949 Val Loss = 2.90576
2023-04-18 17:27:23.453190 Epoch 24  	Train Loss = 2.89514 Val Loss = 2.90058
2023-04-18 17:27:52.301722 Epoch 25  	Train Loss = 2.89145 Val Loss = 2.91855
2023-04-18 17:28:20.810960 Epoch 26  	Train Loss = 2.88728 Val Loss = 2.91353
2023-04-18 17:28:49.199634 Epoch 27  	Train Loss = 2.88447 Val Loss = 2.90600
2023-04-18 17:29:17.415826 Epoch 28  	Train Loss = 2.87999 Val Loss = 2.90725
2023-04-18 17:29:46.865558 Epoch 29  	Train Loss = 2.87730 Val Loss = 2.90625
2023-04-18 17:30:14.944122 Epoch 30  	Train Loss = 2.87270 Val Loss = 2.90626
2023-04-18 17:30:43.681921 Epoch 31  	Train Loss = 2.86929 Val Loss = 2.92299
2023-04-18 17:31:12.158120 Epoch 32  	Train Loss = 2.86720 Val Loss = 2.90621
2023-04-18 17:31:40.719618 Epoch 33  	Train Loss = 2.86296 Val Loss = 2.90579
2023-04-18 17:32:09.503990 Epoch 34  	Train Loss = 2.85927 Val Loss = 2.90389
Early stopping at epoch: 34
Best at epoch 24:
Train Loss = 2.89514
Train RMSE = 5.62934, MAE = 2.85327, MAPE = 7.61139
Val Loss = 2.90058
Val RMSE = 6.08361, MAE = 2.93653, MAPE = 8.30080
--------- Test ---------
All Steps RMSE = 6.50438, MAE = 3.23095, MAPE = 8.98108
Step 1 RMSE = 4.14471, MAE = 2.39709, MAPE = 5.86042
Step 2 RMSE = 4.89592, MAE = 2.65661, MAPE = 6.74628
Step 3 RMSE = 5.40562, MAE = 2.84161, MAPE = 7.44964
Step 4 RMSE = 5.82274, MAE = 2.99437, MAPE = 8.03867
Step 5 RMSE = 6.17565, MAE = 3.12629, MAPE = 8.56059
Step 6 RMSE = 6.48831, MAE = 3.24465, MAPE = 9.02903
Step 7 RMSE = 6.76626, MAE = 3.35281, MAPE = 9.44798
Step 8 RMSE = 7.01730, MAE = 3.45235, MAPE = 9.83511
Step 9 RMSE = 7.24471, MAE = 3.54444, MAPE = 10.19507
Step 10 RMSE = 7.45627, MAE = 3.63270, MAPE = 10.53633
Step 11 RMSE = 7.65217, MAE = 3.71960, MAPE = 10.86681
Step 12 RMSE = 7.84305, MAE = 3.80898, MAPE = 11.20747
Inference time: 2.66 s
