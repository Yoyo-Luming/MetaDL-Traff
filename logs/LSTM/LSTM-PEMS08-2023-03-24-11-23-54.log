PEMS08
Original data shape (17856, 170, 3)
Trainset:	x-(10690, 12, 170, 1)	y-(10690, 12, 170, 1)
Valset:  	x-(3548, 12, 170, 1)  	y-(3548, 12, 170, 1)
Testset:	x-(3549, 12, 170, 1)	y-(3549, 12, 170, 1)

--------- LSTM ---------
{
    "num_nodes": 170,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "lr": 0.01,
    "weight_decay": 0,
    "milestones": [
        10,
        30
    ],
    "clip_grad": 0,
    "batch_size": 64,
    "max_epochs": 200,
    "use_cl": false,
    "load_npz": false,
    "with_embeddings": false,
    "pass_device": false,
    "model_args": {
        "num_nodes": 170,
        "in_steps": 12,
        "out_steps": 12,
        "lstm_input_dim": 1,
        "lstm_hidden_dim": 64
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LSTM                                     --                        --
├─LSTM: 1-1                              [10880, 12, 128]          133,632
├─Linear: 1-2                            [10880, 12]               1,548
==========================================================================================
Total params: 135,180
Trainable params: 135,180
Non-trainable params: 0
Total mult-adds (G): 17.46
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 134.74
Params size (MB): 0.54
Estimated Total Size (MB): 135.80
==========================================================================================

Loss: HuberLoss

2023-03-24 11:24:02.429559 Epoch 1  	Train Loss = 27.36434 Val Loss = 23.40202
2023-03-24 11:24:06.795804 Epoch 2  	Train Loss = 22.40704 Val Loss = 26.63562
2023-03-24 11:24:11.165281 Epoch 3  	Train Loss = 22.22070 Val Loss = 26.15898
2023-03-24 11:24:15.541425 Epoch 4  	Train Loss = 22.07786 Val Loss = 22.34526
2023-03-24 11:24:19.916801 Epoch 5  	Train Loss = 21.90995 Val Loss = 23.46013
2023-03-24 11:24:24.298059 Epoch 6  	Train Loss = 21.84383 Val Loss = 24.22189
2023-03-24 11:24:28.687224 Epoch 7  	Train Loss = 21.75413 Val Loss = 22.09759
2023-03-24 11:24:33.080713 Epoch 8  	Train Loss = 21.48426 Val Loss = 23.31075
2023-03-24 11:24:37.488216 Epoch 9  	Train Loss = 21.54727 Val Loss = 23.02117
2023-03-24 11:24:41.905732 Epoch 10  	Train Loss = 21.41626 Val Loss = 23.06648
2023-03-24 11:24:46.338530 Epoch 11  	Train Loss = 20.99022 Val Loss = 21.20384
2023-03-24 11:24:50.797886 Epoch 12  	Train Loss = 20.83907 Val Loss = 21.13033
2023-03-24 11:24:55.278201 Epoch 13  	Train Loss = 20.83918 Val Loss = 21.08970
2023-03-24 11:24:59.766142 Epoch 14  	Train Loss = 20.77146 Val Loss = 21.11666
2023-03-24 11:25:04.269014 Epoch 15  	Train Loss = 20.85883 Val Loss = 21.19571
2023-03-24 11:25:08.780407 Epoch 16  	Train Loss = 20.77896 Val Loss = 21.04796
2023-03-24 11:25:13.289225 Epoch 17  	Train Loss = 20.72481 Val Loss = 21.35497
2023-03-24 11:25:17.823415 Epoch 18  	Train Loss = 20.73884 Val Loss = 20.94383
2023-03-24 11:25:22.370286 Epoch 19  	Train Loss = 20.72247 Val Loss = 21.06014
2023-03-24 11:25:26.897784 Epoch 20  	Train Loss = 20.70190 Val Loss = 21.02750
2023-03-24 11:25:31.416422 Epoch 21  	Train Loss = 20.69128 Val Loss = 21.00189
2023-03-24 11:25:35.934190 Epoch 22  	Train Loss = 20.65709 Val Loss = 20.97886
2023-03-24 11:25:40.461068 Epoch 23  	Train Loss = 20.67476 Val Loss = 20.98029
2023-03-24 11:25:45.001621 Epoch 24  	Train Loss = 20.57547 Val Loss = 21.14392
2023-03-24 11:25:49.535066 Epoch 25  	Train Loss = 20.63655 Val Loss = 20.88035
2023-03-24 11:25:54.069391 Epoch 26  	Train Loss = 20.58685 Val Loss = 20.90941
2023-03-24 11:25:58.602290 Epoch 27  	Train Loss = 20.62440 Val Loss = 20.77407
2023-03-24 11:26:03.140724 Epoch 28  	Train Loss = 20.59846 Val Loss = 20.79942
2023-03-24 11:26:07.685426 Epoch 29  	Train Loss = 20.56721 Val Loss = 20.86445
2023-03-24 11:26:12.224676 Epoch 30  	Train Loss = 20.60396 Val Loss = 20.94276
2023-03-24 11:26:16.800338 Epoch 31  	Train Loss = 20.46524 Val Loss = 20.67144
2023-03-24 11:26:21.385653 Epoch 32  	Train Loss = 20.39610 Val Loss = 20.68291
2023-03-24 11:26:25.947883 Epoch 33  	Train Loss = 20.44280 Val Loss = 20.67773
2023-03-24 11:26:30.510010 Epoch 34  	Train Loss = 20.41574 Val Loss = 20.66448
2023-03-24 11:26:35.064377 Epoch 35  	Train Loss = 20.47948 Val Loss = 20.66818
2023-03-24 11:26:39.623417 Epoch 36  	Train Loss = 20.39442 Val Loss = 20.65953
2023-03-24 11:26:44.193898 Epoch 37  	Train Loss = 20.42614 Val Loss = 20.66216
2023-03-24 11:26:48.763822 Epoch 38  	Train Loss = 20.50070 Val Loss = 20.66009
2023-03-24 11:26:53.327226 Epoch 39  	Train Loss = 20.42328 Val Loss = 20.65164
2023-03-24 11:26:57.880508 Epoch 40  	Train Loss = 20.40086 Val Loss = 20.64923
2023-03-24 11:27:02.440792 Epoch 41  	Train Loss = 20.39200 Val Loss = 20.66705
2023-03-24 11:27:07.011092 Epoch 42  	Train Loss = 20.44287 Val Loss = 20.64604
2023-03-24 11:27:11.573447 Epoch 43  	Train Loss = 20.35285 Val Loss = 20.64126
2023-03-24 11:27:16.137613 Epoch 44  	Train Loss = 20.37780 Val Loss = 20.64376
2023-03-24 11:27:20.701881 Epoch 45  	Train Loss = 20.38547 Val Loss = 20.63398
2023-03-24 11:27:25.265289 Epoch 46  	Train Loss = 20.37921 Val Loss = 20.64849
2023-03-24 11:27:29.833347 Epoch 47  	Train Loss = 20.41472 Val Loss = 20.63088
2023-03-24 11:27:34.397449 Epoch 48  	Train Loss = 20.47280 Val Loss = 20.63776
2023-03-24 11:27:38.968699 Epoch 49  	Train Loss = 20.36736 Val Loss = 20.62822
2023-03-24 11:27:43.521194 Epoch 50  	Train Loss = 20.37673 Val Loss = 20.63361
2023-03-24 11:27:48.106858 Epoch 51  	Train Loss = 20.43872 Val Loss = 20.63276
2023-03-24 11:27:52.678257 Epoch 52  	Train Loss = 20.41196 Val Loss = 20.62104
2023-03-24 11:27:57.252262 Epoch 53  	Train Loss = 20.40233 Val Loss = 20.61657
2023-03-24 11:28:01.819016 Epoch 54  	Train Loss = 20.36487 Val Loss = 20.61611
2023-03-24 11:28:06.389090 Epoch 55  	Train Loss = 20.38439 Val Loss = 20.60201
2023-03-24 11:28:10.957435 Epoch 56  	Train Loss = 20.41171 Val Loss = 20.60951
2023-03-24 11:28:15.526138 Epoch 57  	Train Loss = 20.37645 Val Loss = 20.61749
2023-03-24 11:28:20.099588 Epoch 58  	Train Loss = 20.36062 Val Loss = 20.59782
2023-03-24 11:28:24.666899 Epoch 59  	Train Loss = 20.37337 Val Loss = 20.59793
2023-03-24 11:28:29.224239 Epoch 60  	Train Loss = 20.37107 Val Loss = 20.59959
2023-03-24 11:28:33.784186 Epoch 61  	Train Loss = 20.39731 Val Loss = 20.59851
2023-03-24 11:28:38.349042 Epoch 62  	Train Loss = 20.40988 Val Loss = 20.59446
2023-03-24 11:28:42.917004 Epoch 63  	Train Loss = 20.38856 Val Loss = 20.58754
2023-03-24 11:28:47.471178 Epoch 64  	Train Loss = 20.36902 Val Loss = 20.58957
2023-03-24 11:28:52.045550 Epoch 65  	Train Loss = 20.41322 Val Loss = 20.59611
2023-03-24 11:28:56.617273 Epoch 66  	Train Loss = 20.34536 Val Loss = 20.58781
2023-03-24 11:29:01.188056 Epoch 67  	Train Loss = 20.41860 Val Loss = 20.59247
2023-03-24 11:29:05.795879 Epoch 68  	Train Loss = 20.36730 Val Loss = 20.58166
2023-03-24 11:29:10.373208 Epoch 69  	Train Loss = 20.38586 Val Loss = 20.57980
2023-03-24 11:29:14.951643 Epoch 70  	Train Loss = 20.33445 Val Loss = 20.57728
2023-03-24 11:29:19.520627 Epoch 71  	Train Loss = 20.35832 Val Loss = 20.57229
2023-03-24 11:29:24.085421 Epoch 72  	Train Loss = 20.33550 Val Loss = 20.57869
2023-03-24 11:29:28.660457 Epoch 73  	Train Loss = 20.36359 Val Loss = 20.56982
2023-03-24 11:29:33.231792 Epoch 74  	Train Loss = 20.36334 Val Loss = 20.56697
2023-03-24 11:29:37.809534 Epoch 75  	Train Loss = 20.38647 Val Loss = 20.60234
2023-03-24 11:29:42.383663 Epoch 76  	Train Loss = 20.36664 Val Loss = 20.55861
2023-03-24 11:29:46.952041 Epoch 77  	Train Loss = 20.34771 Val Loss = 20.56800
2023-03-24 11:29:51.544547 Epoch 78  	Train Loss = 20.35718 Val Loss = 20.57642
2023-03-24 11:29:56.128750 Epoch 79  	Train Loss = 20.35495 Val Loss = 20.57447
2023-03-24 11:30:00.704923 Epoch 80  	Train Loss = 20.34870 Val Loss = 20.55140
2023-03-24 11:30:05.273936 Epoch 81  	Train Loss = 20.35716 Val Loss = 20.55283
2023-03-24 11:30:09.845599 Epoch 82  	Train Loss = 20.34043 Val Loss = 20.55337
2023-03-24 11:30:14.434947 Epoch 83  	Train Loss = 20.31637 Val Loss = 20.55185
2023-03-24 11:30:19.009823 Epoch 84  	Train Loss = 20.33957 Val Loss = 20.55592
2023-03-24 11:30:23.577862 Epoch 85  	Train Loss = 20.34831 Val Loss = 20.55717
2023-03-24 11:30:28.142600 Epoch 86  	Train Loss = 20.32211 Val Loss = 20.55783
2023-03-24 11:30:32.706623 Epoch 87  	Train Loss = 20.35901 Val Loss = 20.54237
2023-03-24 11:30:37.284067 Epoch 88  	Train Loss = 20.37441 Val Loss = 20.53397
2023-03-24 11:30:41.865530 Epoch 89  	Train Loss = 20.29352 Val Loss = 20.55019
2023-03-24 11:30:46.436608 Epoch 90  	Train Loss = 20.32538 Val Loss = 20.54743
2023-03-24 11:30:51.008032 Epoch 91  	Train Loss = 20.30407 Val Loss = 20.52985
2023-03-24 11:30:55.575602 Epoch 92  	Train Loss = 20.29747 Val Loss = 20.53457
2023-03-24 11:31:00.155949 Epoch 93  	Train Loss = 20.33530 Val Loss = 20.51964
2023-03-24 11:31:04.747381 Epoch 94  	Train Loss = 20.32248 Val Loss = 20.52712
2023-03-24 11:31:09.366110 Epoch 95  	Train Loss = 20.32906 Val Loss = 20.51908
2023-03-24 11:31:13.980448 Epoch 96  	Train Loss = 20.32531 Val Loss = 20.52333
2023-03-24 11:31:18.556046 Epoch 97  	Train Loss = 20.30969 Val Loss = 20.51368
2023-03-24 11:31:23.142538 Epoch 98  	Train Loss = 20.31340 Val Loss = 20.52799
2023-03-24 11:31:27.750930 Epoch 99  	Train Loss = 20.28458 Val Loss = 20.52424
2023-03-24 11:31:32.363907 Epoch 100  	Train Loss = 20.34876 Val Loss = 20.51109
2023-03-24 11:31:36.966781 Epoch 101  	Train Loss = 20.30636 Val Loss = 20.51301
2023-03-24 11:31:41.566751 Epoch 102  	Train Loss = 20.25867 Val Loss = 20.52412
2023-03-24 11:31:46.139485 Epoch 103  	Train Loss = 20.31497 Val Loss = 20.50673
2023-03-24 11:31:50.709700 Epoch 104  	Train Loss = 20.26782 Val Loss = 20.53598
2023-03-24 11:31:55.298804 Epoch 105  	Train Loss = 20.25994 Val Loss = 20.50495
2023-03-24 11:31:59.877819 Epoch 106  	Train Loss = 20.30272 Val Loss = 20.52852
2023-03-24 11:32:04.458999 Epoch 107  	Train Loss = 20.27005 Val Loss = 20.50981
2023-03-24 11:32:09.041497 Epoch 108  	Train Loss = 20.31843 Val Loss = 20.50922
2023-03-24 11:32:13.616416 Epoch 109  	Train Loss = 20.27922 Val Loss = 20.49787
2023-03-24 11:32:18.184288 Epoch 110  	Train Loss = 20.31561 Val Loss = 20.49409
2023-03-24 11:32:22.754493 Epoch 111  	Train Loss = 20.26044 Val Loss = 20.48803
2023-03-24 11:32:27.324675 Epoch 112  	Train Loss = 20.28859 Val Loss = 20.50149
2023-03-24 11:32:31.893278 Epoch 113  	Train Loss = 20.29060 Val Loss = 20.48563
2023-03-24 11:32:36.474928 Epoch 114  	Train Loss = 20.28505 Val Loss = 20.47882
2023-03-24 11:32:41.046870 Epoch 115  	Train Loss = 20.28485 Val Loss = 20.48160
2023-03-24 11:32:45.616668 Epoch 116  	Train Loss = 20.28852 Val Loss = 20.50355
2023-03-24 11:32:50.183312 Epoch 117  	Train Loss = 20.33014 Val Loss = 20.47405
2023-03-24 11:32:54.767051 Epoch 118  	Train Loss = 20.24883 Val Loss = 20.49188
2023-03-24 11:32:59.343691 Epoch 119  	Train Loss = 20.25982 Val Loss = 20.47501
2023-03-24 11:33:03.942924 Epoch 120  	Train Loss = 20.28223 Val Loss = 20.47402
2023-03-24 11:33:08.516470 Epoch 121  	Train Loss = 20.27079 Val Loss = 20.47307
2023-03-24 11:33:13.077807 Epoch 122  	Train Loss = 20.27205 Val Loss = 20.47039
2023-03-24 11:33:17.662865 Epoch 123  	Train Loss = 20.26287 Val Loss = 20.47738
2023-03-24 11:33:22.230677 Epoch 124  	Train Loss = 20.29986 Val Loss = 20.48490
2023-03-24 11:33:26.798489 Epoch 125  	Train Loss = 20.29299 Val Loss = 20.46057
2023-03-24 11:33:31.372919 Epoch 126  	Train Loss = 20.19697 Val Loss = 20.48068
2023-03-24 11:33:35.949652 Epoch 127  	Train Loss = 20.25105 Val Loss = 20.45488
2023-03-24 11:33:40.519484 Epoch 128  	Train Loss = 20.21895 Val Loss = 20.45514
2023-03-24 11:33:45.090041 Epoch 129  	Train Loss = 20.27544 Val Loss = 20.45335
2023-03-24 11:33:49.658830 Epoch 130  	Train Loss = 20.25010 Val Loss = 20.44798
2023-03-24 11:33:54.227227 Epoch 131  	Train Loss = 20.28739 Val Loss = 20.45111
2023-03-24 11:33:58.819027 Epoch 132  	Train Loss = 20.23429 Val Loss = 20.43875
2023-03-24 11:34:03.399620 Epoch 133  	Train Loss = 20.24709 Val Loss = 20.45923
2023-03-24 11:34:07.971816 Epoch 134  	Train Loss = 20.22297 Val Loss = 20.45793
2023-03-24 11:34:12.534045 Epoch 135  	Train Loss = 20.20747 Val Loss = 20.44983
2023-03-24 11:34:17.103761 Epoch 136  	Train Loss = 20.26248 Val Loss = 20.46430
2023-03-24 11:34:21.669269 Epoch 137  	Train Loss = 20.20755 Val Loss = 20.44069
2023-03-24 11:34:26.240964 Epoch 138  	Train Loss = 20.22197 Val Loss = 20.44576
2023-03-24 11:34:30.808037 Epoch 139  	Train Loss = 20.26145 Val Loss = 20.42268
2023-03-24 11:34:35.375260 Epoch 140  	Train Loss = 20.23417 Val Loss = 20.43479
2023-03-24 11:34:39.950344 Epoch 141  	Train Loss = 20.20010 Val Loss = 20.42140
2023-03-24 11:34:44.523103 Epoch 142  	Train Loss = 20.21123 Val Loss = 20.42698
2023-03-24 11:34:49.100773 Epoch 143  	Train Loss = 20.18833 Val Loss = 20.42620
2023-03-24 11:34:53.657572 Epoch 144  	Train Loss = 20.20159 Val Loss = 20.41938
2023-03-24 11:34:58.223442 Epoch 145  	Train Loss = 20.22615 Val Loss = 20.43709
2023-03-24 11:35:02.789475 Epoch 146  	Train Loss = 20.22384 Val Loss = 20.41554
2023-03-24 11:35:07.353057 Epoch 147  	Train Loss = 20.21144 Val Loss = 20.43946
2023-03-24 11:35:11.905683 Epoch 148  	Train Loss = 20.22637 Val Loss = 20.41038
2023-03-24 11:35:16.467952 Epoch 149  	Train Loss = 20.22960 Val Loss = 20.41090
2023-03-24 11:35:21.024627 Epoch 150  	Train Loss = 20.20879 Val Loss = 20.40271
2023-03-24 11:35:25.574828 Epoch 151  	Train Loss = 20.22230 Val Loss = 20.39338
2023-03-24 11:35:30.122805 Epoch 152  	Train Loss = 20.22738 Val Loss = 20.42180
2023-03-24 11:35:34.674510 Epoch 153  	Train Loss = 20.21667 Val Loss = 20.40799
2023-03-24 11:35:39.224663 Epoch 154  	Train Loss = 20.23502 Val Loss = 20.39756
2023-03-24 11:35:43.781283 Epoch 155  	Train Loss = 20.16077 Val Loss = 20.39432
2023-03-24 11:35:48.329118 Epoch 156  	Train Loss = 20.16786 Val Loss = 20.40768
2023-03-24 11:35:52.878137 Epoch 157  	Train Loss = 20.22731 Val Loss = 20.42814
2023-03-24 11:35:57.442578 Epoch 158  	Train Loss = 20.17462 Val Loss = 20.39576
2023-03-24 11:36:02.028864 Epoch 159  	Train Loss = 20.20753 Val Loss = 20.40047
2023-03-24 11:36:06.609296 Epoch 160  	Train Loss = 20.19109 Val Loss = 20.39550
2023-03-24 11:36:11.188298 Epoch 161  	Train Loss = 20.23056 Val Loss = 20.40877
Early stopping at epoch: 161
Best at epoch 151:
Train Loss = 20.22230
Train RMSE = 32.64610, MAE = 20.70827, MAPE = 13.22439
Val Loss = 20.39338
Val RMSE = 32.82189, MAE = 20.88491, MAPE = 13.49865
--------- Test ---------
All Steps RMSE = 31.71083, MAE = 20.33999, MAPE = 12.94684
Step 1 RMSE = 21.34267, MAE = 13.91495, MAPE = 8.91234
Step 2 RMSE = 23.73602, MAE = 15.38829, MAPE = 9.71854
Step 3 RMSE = 25.75718, MAE = 16.63453, MAPE = 10.46409
Step 4 RMSE = 27.48649, MAE = 17.67603, MAPE = 11.08349
Step 5 RMSE = 29.08687, MAE = 18.68765, MAPE = 11.69019
Step 6 RMSE = 30.69113, MAE = 19.76542, MAPE = 12.43159
Step 7 RMSE = 32.25727, MAE = 20.88432, MAPE = 13.26799
Step 8 RMSE = 33.77632, MAE = 21.96416, MAPE = 13.98570
Step 9 RMSE = 35.18585, MAE = 23.03388, MAPE = 14.72793
Step 10 RMSE = 36.63541, MAE = 24.08119, MAPE = 15.41728
Step 11 RMSE = 38.25772, MAE = 25.29602, MAPE = 16.35076
Step 12 RMSE = 40.19807, MAE = 26.75343, MAPE = 17.31232
