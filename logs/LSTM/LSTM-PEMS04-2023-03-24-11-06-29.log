PEMS04
Original data shape (16992, 307, 3)
Trainset:	x-(10172, 12, 307, 1)	y-(10172, 12, 307, 1)
Valset:  	x-(3375, 12, 307, 1)  	y-(3375, 12, 307, 1)
Testset:	x-(3376, 12, 307, 1)	y-(3376, 12, 307, 1)

--------- LSTM ---------
{
    "num_nodes": 307,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.6,
    "val_size": 0.2,
    "lr": 0.01,
    "weight_decay": 0,
    "milestones": [
        10,
        30
    ],
    "clip_grad": 0,
    "batch_size": 64,
    "max_epochs": 200,
    "use_cl": false,
    "load_npz": false,
    "with_embeddings": false,
    "pass_device": false,
    "model_args": {
        "num_nodes": 307,
        "in_steps": 12,
        "out_steps": 12,
        "lstm_input_dim": 1,
        "lstm_hidden_dim": 64
    }
}

Loss: HuberLoss

2023-03-24 11:06:40.450683 Epoch 1  	Train Loss = 33.24653 Val Loss = 29.18703
2023-03-24 11:06:48.003081 Epoch 2  	Train Loss = 26.68748 Val Loss = 27.84856
2023-03-24 11:06:55.512199 Epoch 3  	Train Loss = 26.31687 Val Loss = 27.28693
2023-03-24 11:07:03.065176 Epoch 4  	Train Loss = 26.21977 Val Loss = 27.02081
2023-03-24 11:07:10.626661 Epoch 5  	Train Loss = 25.97244 Val Loss = 27.15606
2023-03-24 11:07:18.214562 Epoch 6  	Train Loss = 25.88341 Val Loss = 27.17196
2023-03-24 11:07:25.840786 Epoch 7  	Train Loss = 26.03715 Val Loss = 27.02789
2023-03-24 11:07:33.458702 Epoch 8  	Train Loss = 25.72720 Val Loss = 26.69236
2023-03-24 11:07:41.130373 Epoch 9  	Train Loss = 25.71583 Val Loss = 26.89691
2023-03-24 11:07:48.853412 Epoch 10  	Train Loss = 25.59151 Val Loss = 26.52463
2023-03-24 11:07:56.589828 Epoch 11  	Train Loss = 25.30654 Val Loss = 26.44660
2023-03-24 11:08:04.389529 Epoch 12  	Train Loss = 25.29708 Val Loss = 26.43730
2023-03-24 11:08:12.159927 Epoch 13  	Train Loss = 25.28372 Val Loss = 26.47071
2023-03-24 11:08:19.975535 Epoch 14  	Train Loss = 25.28241 Val Loss = 26.42094
2023-03-24 11:08:27.810133 Epoch 15  	Train Loss = 25.27674 Val Loss = 26.40248
2023-03-24 11:08:35.660182 Epoch 16  	Train Loss = 25.27960 Val Loss = 26.40597
2023-03-24 11:08:43.538526 Epoch 17  	Train Loss = 25.27442 Val Loss = 26.48634
2023-03-24 11:08:51.384344 Epoch 18  	Train Loss = 25.28703 Val Loss = 26.43315
2023-03-24 11:08:59.258094 Epoch 19  	Train Loss = 25.27300 Val Loss = 26.36350
2023-03-24 11:09:07.127588 Epoch 20  	Train Loss = 25.27002 Val Loss = 26.41081
2023-03-24 11:09:14.972648 Epoch 21  	Train Loss = 25.26822 Val Loss = 26.40655
2023-03-24 11:09:22.858190 Epoch 22  	Train Loss = 25.28278 Val Loss = 26.39375
2023-03-24 11:09:30.718735 Epoch 23  	Train Loss = 25.25724 Val Loss = 26.36834
2023-03-24 11:09:38.591382 Epoch 24  	Train Loss = 25.25489 Val Loss = 26.36654
2023-03-24 11:09:46.359590 Epoch 25  	Train Loss = 25.25578 Val Loss = 26.42270
2023-03-24 11:09:54.156408 Epoch 26  	Train Loss = 25.26388 Val Loss = 26.34008
2023-03-24 11:10:01.937343 Epoch 27  	Train Loss = 25.24878 Val Loss = 26.42428
2023-03-24 11:10:09.724207 Epoch 28  	Train Loss = 25.24949 Val Loss = 26.38102
2023-03-24 11:10:17.500481 Epoch 29  	Train Loss = 25.23476 Val Loss = 26.42806
2023-03-24 11:10:25.275123 Epoch 30  	Train Loss = 25.23737 Val Loss = 26.33678
2023-03-24 11:10:33.070617 Epoch 31  	Train Loss = 25.17506 Val Loss = 26.30667
2023-03-24 11:10:40.857674 Epoch 32  	Train Loss = 25.17255 Val Loss = 26.31197
2023-03-24 11:10:48.642982 Epoch 33  	Train Loss = 25.17199 Val Loss = 26.31892
2023-03-24 11:10:56.427257 Epoch 34  	Train Loss = 25.17498 Val Loss = 26.29749
2023-03-24 11:11:04.202629 Epoch 35  	Train Loss = 25.17262 Val Loss = 26.30100
2023-03-24 11:11:11.999054 Epoch 36  	Train Loss = 25.17105 Val Loss = 26.30373
2023-03-24 11:11:19.818660 Epoch 37  	Train Loss = 25.17259 Val Loss = 26.31358
2023-03-24 11:11:27.633803 Epoch 38  	Train Loss = 25.17105 Val Loss = 26.31745
2023-03-24 11:11:35.422804 Epoch 39  	Train Loss = 25.16692 Val Loss = 26.29411
2023-03-24 11:11:43.207088 Epoch 40  	Train Loss = 25.16825 Val Loss = 26.30201
2023-03-24 11:11:51.001846 Epoch 41  	Train Loss = 25.16811 Val Loss = 26.30109
2023-03-24 11:11:58.804615 Epoch 42  	Train Loss = 25.16657 Val Loss = 26.28611
2023-03-24 11:12:06.607535 Epoch 43  	Train Loss = 25.16725 Val Loss = 26.28717
2023-03-24 11:12:14.392378 Epoch 44  	Train Loss = 25.16569 Val Loss = 26.29514
2023-03-24 11:12:22.185068 Epoch 45  	Train Loss = 25.16257 Val Loss = 26.28910
2023-03-24 11:12:30.002108 Epoch 46  	Train Loss = 25.16341 Val Loss = 26.29263
2023-03-24 11:12:37.827895 Epoch 47  	Train Loss = 25.16347 Val Loss = 26.29779
2023-03-24 11:12:45.648258 Epoch 48  	Train Loss = 25.16526 Val Loss = 26.30224
2023-03-24 11:12:53.469606 Epoch 49  	Train Loss = 25.16232 Val Loss = 26.28169
2023-03-24 11:13:01.276457 Epoch 50  	Train Loss = 25.16152 Val Loss = 26.30267
2023-03-24 11:13:09.108997 Epoch 51  	Train Loss = 25.16216 Val Loss = 26.30045
2023-03-24 11:13:16.925424 Epoch 52  	Train Loss = 25.15850 Val Loss = 26.29370
2023-03-24 11:13:24.742192 Epoch 53  	Train Loss = 25.15580 Val Loss = 26.28740
2023-03-24 11:13:32.558910 Epoch 54  	Train Loss = 25.15564 Val Loss = 26.27436
2023-03-24 11:13:40.379165 Epoch 55  	Train Loss = 25.15516 Val Loss = 26.28953
2023-03-24 11:13:48.221730 Epoch 56  	Train Loss = 25.15865 Val Loss = 26.29357
2023-03-24 11:13:56.045009 Epoch 57  	Train Loss = 25.15602 Val Loss = 26.28983
2023-03-24 11:14:03.855124 Epoch 58  	Train Loss = 25.15338 Val Loss = 26.27621
2023-03-24 11:14:11.671187 Epoch 59  	Train Loss = 25.15437 Val Loss = 26.31191
2023-03-24 11:14:19.501614 Epoch 60  	Train Loss = 25.15290 Val Loss = 26.28227
2023-03-24 11:14:27.338850 Epoch 61  	Train Loss = 25.15469 Val Loss = 26.28197
2023-03-24 11:14:35.185411 Epoch 62  	Train Loss = 25.15191 Val Loss = 26.27133
2023-03-24 11:14:42.999321 Epoch 63  	Train Loss = 25.15202 Val Loss = 26.27229
2023-03-24 11:14:50.807534 Epoch 64  	Train Loss = 25.15023 Val Loss = 26.27286
2023-03-24 11:14:58.620561 Epoch 65  	Train Loss = 25.15193 Val Loss = 26.27831
2023-03-24 11:15:06.446585 Epoch 66  	Train Loss = 25.14866 Val Loss = 26.27400
2023-03-24 11:15:14.258757 Epoch 67  	Train Loss = 25.14743 Val Loss = 26.26749
2023-03-24 11:15:22.082539 Epoch 68  	Train Loss = 25.14430 Val Loss = 26.28343
2023-03-24 11:15:29.890446 Epoch 69  	Train Loss = 25.14550 Val Loss = 26.28420
2023-03-24 11:15:37.715070 Epoch 70  	Train Loss = 25.14310 Val Loss = 26.27367
2023-03-24 11:15:45.540865 Epoch 71  	Train Loss = 25.14575 Val Loss = 26.27773
2023-03-24 11:15:53.368091 Epoch 72  	Train Loss = 25.14514 Val Loss = 26.27227
2023-03-24 11:16:01.192776 Epoch 73  	Train Loss = 25.14098 Val Loss = 26.27867
2023-03-24 11:16:09.022489 Epoch 74  	Train Loss = 25.14063 Val Loss = 26.26430
2023-03-24 11:16:16.824200 Epoch 75  	Train Loss = 25.13862 Val Loss = 26.26066
2023-03-24 11:16:24.663148 Epoch 76  	Train Loss = 25.14124 Val Loss = 26.27015
2023-03-24 11:16:32.486261 Epoch 77  	Train Loss = 25.13667 Val Loss = 26.26157
2023-03-24 11:16:40.296151 Epoch 78  	Train Loss = 25.13528 Val Loss = 26.26559
2023-03-24 11:16:48.088975 Epoch 79  	Train Loss = 25.14122 Val Loss = 26.26568
2023-03-24 11:16:55.889998 Epoch 80  	Train Loss = 25.13936 Val Loss = 26.25472
2023-03-24 11:17:03.725301 Epoch 81  	Train Loss = 25.13612 Val Loss = 26.25830
2023-03-24 11:17:11.562988 Epoch 82  	Train Loss = 25.13232 Val Loss = 26.24676
2023-03-24 11:17:19.389212 Epoch 83  	Train Loss = 25.13374 Val Loss = 26.26238
2023-03-24 11:17:27.208789 Epoch 84  	Train Loss = 25.13079 Val Loss = 26.26639
2023-03-24 11:17:35.038314 Epoch 85  	Train Loss = 25.13238 Val Loss = 26.25983
2023-03-24 11:17:42.880733 Epoch 86  	Train Loss = 25.12955 Val Loss = 26.25112
2023-03-24 11:17:50.705097 Epoch 87  	Train Loss = 25.12792 Val Loss = 26.27603
2023-03-24 11:17:58.532368 Epoch 88  	Train Loss = 25.12880 Val Loss = 26.26369
2023-03-24 11:18:06.345203 Epoch 89  	Train Loss = 25.12764 Val Loss = 26.23681
2023-03-24 11:18:14.151052 Epoch 90  	Train Loss = 25.12592 Val Loss = 26.24735
2023-03-24 11:18:21.981749 Epoch 91  	Train Loss = 25.12392 Val Loss = 26.24440
2023-03-24 11:18:29.805585 Epoch 92  	Train Loss = 25.12101 Val Loss = 26.24242
2023-03-24 11:18:37.624450 Epoch 93  	Train Loss = 25.11928 Val Loss = 26.25041
2023-03-24 11:18:45.444532 Epoch 94  	Train Loss = 25.11762 Val Loss = 26.24570
2023-03-24 11:18:53.243598 Epoch 95  	Train Loss = 25.11792 Val Loss = 26.23404
2023-03-24 11:19:01.080503 Epoch 96  	Train Loss = 25.11762 Val Loss = 26.24561
2023-03-24 11:19:08.912234 Epoch 97  	Train Loss = 25.11545 Val Loss = 26.22969
2023-03-24 11:19:16.745220 Epoch 98  	Train Loss = 25.11681 Val Loss = 26.23517
2023-03-24 11:19:24.567805 Epoch 99  	Train Loss = 25.11514 Val Loss = 26.23485
2023-03-24 11:19:32.389720 Epoch 100  	Train Loss = 25.11276 Val Loss = 26.22961
2023-03-24 11:19:40.206675 Epoch 101  	Train Loss = 25.11025 Val Loss = 26.24615
2023-03-24 11:19:48.032041 Epoch 102  	Train Loss = 25.11071 Val Loss = 26.24382
2023-03-24 11:19:55.811445 Epoch 103  	Train Loss = 25.10824 Val Loss = 26.23924
2023-03-24 11:20:03.611501 Epoch 104  	Train Loss = 25.10525 Val Loss = 26.23316
2023-03-24 11:20:11.437144 Epoch 105  	Train Loss = 25.10838 Val Loss = 26.22093
2023-03-24 11:20:19.273306 Epoch 106  	Train Loss = 25.10967 Val Loss = 26.22361
2023-03-24 11:20:27.095038 Epoch 107  	Train Loss = 25.10430 Val Loss = 26.24787
2023-03-24 11:20:34.902919 Epoch 108  	Train Loss = 25.10319 Val Loss = 26.22585
2023-03-24 11:20:42.713959 Epoch 109  	Train Loss = 25.10163 Val Loss = 26.21496
2023-03-24 11:20:50.500646 Epoch 110  	Train Loss = 25.10306 Val Loss = 26.23162
2023-03-24 11:20:58.313830 Epoch 111  	Train Loss = 25.10134 Val Loss = 26.23162
2023-03-24 11:21:06.128223 Epoch 112  	Train Loss = 25.09930 Val Loss = 26.20861
2023-03-24 11:21:13.917603 Epoch 113  	Train Loss = 25.09594 Val Loss = 26.20914
2023-03-24 11:21:21.704579 Epoch 114  	Train Loss = 25.09848 Val Loss = 26.22127
2023-03-24 11:21:29.483702 Epoch 115  	Train Loss = 25.09870 Val Loss = 26.22924
2023-03-24 11:21:37.268409 Epoch 116  	Train Loss = 25.09608 Val Loss = 26.20981
2023-03-24 11:21:45.054087 Epoch 117  	Train Loss = 25.09623 Val Loss = 26.22056
2023-03-24 11:21:52.838073 Epoch 118  	Train Loss = 25.09197 Val Loss = 26.21449
2023-03-24 11:22:00.617015 Epoch 119  	Train Loss = 25.09482 Val Loss = 26.21710
2023-03-24 11:22:08.394606 Epoch 120  	Train Loss = 25.09407 Val Loss = 26.21662
2023-03-24 11:22:16.196042 Epoch 121  	Train Loss = 25.08879 Val Loss = 26.21340
2023-03-24 11:22:24.002841 Epoch 122  	Train Loss = 25.08575 Val Loss = 26.21569
Early stopping at epoch: 122
Best at epoch 112:
Train Loss = 25.09930
Train RMSE = 40.10059, MAE = 25.83003, MAPE = 18.70075
Val Loss = 26.20861
Val RMSE = 41.92493, MAE = 27.05359, MAPE = 18.11971
--------- Test ---------
All Steps RMSE = 39.96674, MAE = 25.92991, MAPE = 17.57029
Step 1 RMSE = 28.93863, MAE = 18.30302, MAPE = 12.19139
Step 2 RMSE = 31.15702, MAE = 19.85964, MAPE = 13.21729
Step 3 RMSE = 33.20029, MAE = 21.32367, MAPE = 14.18735
Step 4 RMSE = 34.98496, MAE = 22.60460, MAPE = 15.07762
Step 5 RMSE = 36.72845, MAE = 23.85607, MAPE = 15.93526
Step 6 RMSE = 38.50243, MAE = 25.16668, MAPE = 16.90450
Step 7 RMSE = 40.39402, MAE = 26.56634, MAPE = 17.92499
Step 8 RMSE = 42.24266, MAE = 27.94122, MAPE = 18.93355
Step 9 RMSE = 44.00953, MAE = 29.25107, MAPE = 19.92611
Step 10 RMSE = 45.76603, MAE = 30.59187, MAPE = 20.98962
Step 11 RMSE = 47.65299, MAE = 32.03475, MAPE = 22.17113
Step 12 RMSE = 49.83930, MAE = 33.65992, MAPE = 23.38459
