METRLA
Original data shape (34272, 207)
Trainset:	x-(23967, 12, 207, 1)	y-(23967, 12, 207, 1)
Valset:  	x-(3404, 12, 207, 1)  	y-(3404, 12, 207, 1)
Testset:	x-(6832, 12, 207, 1)	y-(6832, 12, 207, 1)

--------- GRU ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "lr": 0.01,
    "weight_decay": 0,
    "milestones": [
        10,
        20
    ],
    "clip_grad": 0,
    "batch_size": 64,
    "max_epochs": 200,
    "use_cl": false,
    "model_args": {
        "num_nodes": 207,
        "in_steps": 12,
        "out_steps": 12,
        "input_dim": 1,
        "output_dim": 1,
        "gru_hidden_dim": 64,
        "num_layers": 3,
        "seq2seq": true
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
GRU                                      [64, 12, 207, 1]          --
├─GRU: 1-1                               [13248, 12, 64]           62,784
├─GRU: 1-2                               [13248, 1, 64]            62,784
├─Linear: 1-3                            [13248, 1, 1]             65
├─GRU: 1-4                               [13248, 1, 64]            (recursive)
├─Linear: 1-5                            [13248, 1, 1]             (recursive)
├─GRU: 1-6                               [13248, 1, 64]            (recursive)
├─Linear: 1-7                            [13248, 1, 1]             (recursive)
├─GRU: 1-8                               [13248, 1, 64]            (recursive)
├─Linear: 1-9                            [13248, 1, 1]             (recursive)
├─GRU: 1-10                              [13248, 1, 64]            (recursive)
├─Linear: 1-11                           [13248, 1, 1]             (recursive)
├─GRU: 1-12                              [13248, 1, 64]            (recursive)
├─Linear: 1-13                           [13248, 1, 1]             (recursive)
├─GRU: 1-14                              [13248, 1, 64]            (recursive)
├─Linear: 1-15                           [13248, 1, 1]             (recursive)
├─GRU: 1-16                              [13248, 1, 64]            (recursive)
├─Linear: 1-17                           [13248, 1, 1]             (recursive)
├─GRU: 1-18                              [13248, 1, 64]            (recursive)
├─Linear: 1-19                           [13248, 1, 1]             (recursive)
├─GRU: 1-20                              [13248, 1, 64]            (recursive)
├─Linear: 1-21                           [13248, 1, 1]             (recursive)
├─GRU: 1-22                              [13248, 1, 64]            (recursive)
├─Linear: 1-23                           [13248, 1, 1]             (recursive)
├─GRU: 1-24                              [13248, 1, 64]            (recursive)
├─Linear: 1-25                           [13248, 1, 1]             (recursive)
==========================================================================================
Total params: 125,633
Trainable params: 125,633
Non-trainable params: 0
Total mult-adds (G): 19.97
==========================================================================================
Input size (MB): 0.64
Forward/backward pass size (MB): 164.06
Params size (MB): 0.50
Estimated Total Size (MB): 165.20
==========================================================================================

Loss: MaskedMAELoss

2023-04-16 12:27:04.322888 Epoch 1  	Train Loss = 4.08455 Val Loss = 3.40846
2023-04-16 12:27:20.979204 Epoch 2  	Train Loss = 3.72827 Val Loss = 3.40503
2023-04-16 12:27:37.847648 Epoch 3  	Train Loss = 3.65562 Val Loss = 3.35353
2023-04-16 12:27:54.771570 Epoch 4  	Train Loss = 3.61050 Val Loss = 3.34419
2023-04-16 12:28:11.638807 Epoch 5  	Train Loss = 3.60447 Val Loss = 3.34906
2023-04-16 12:28:28.439877 Epoch 6  	Train Loss = 3.60414 Val Loss = 3.35265
2023-04-16 12:28:45.451636 Epoch 7  	Train Loss = 3.61321 Val Loss = 3.33168
2023-04-16 12:29:02.817967 Epoch 8  	Train Loss = 3.59280 Val Loss = 3.33508
2023-04-16 12:29:19.683584 Epoch 9  	Train Loss = 3.59203 Val Loss = 3.36878
2023-04-16 12:29:36.377788 Epoch 10  	Train Loss = 3.82270 Val Loss = 3.39947
2023-04-16 12:29:53.538031 Epoch 11  	Train Loss = 3.61750 Val Loss = 3.35308
2023-04-16 12:30:10.586431 Epoch 12  	Train Loss = 3.60340 Val Loss = 3.34659
2023-04-16 12:30:27.500624 Epoch 13  	Train Loss = 3.59491 Val Loss = 3.34307
2023-04-16 12:30:44.601202 Epoch 14  	Train Loss = 3.59064 Val Loss = 3.33985
2023-04-16 12:31:01.568097 Epoch 15  	Train Loss = 3.58679 Val Loss = 3.33567
2023-04-16 12:31:18.538791 Epoch 16  	Train Loss = 3.58324 Val Loss = 3.33125
2023-04-16 12:31:35.578012 Epoch 17  	Train Loss = 3.58132 Val Loss = 3.33474
2023-04-16 12:31:52.666331 Epoch 18  	Train Loss = 3.57928 Val Loss = 3.32863
2023-04-16 12:32:09.743617 Epoch 19  	Train Loss = 3.57810 Val Loss = 3.32918
2023-04-16 12:32:26.798406 Epoch 20  	Train Loss = 3.57517 Val Loss = 3.33083
2023-04-16 12:32:43.570393 Epoch 21  	Train Loss = 3.56903 Val Loss = 3.32648
2023-04-16 12:33:00.677956 Epoch 22  	Train Loss = 3.56892 Val Loss = 3.32477
2023-04-16 12:33:17.628409 Epoch 23  	Train Loss = 3.56812 Val Loss = 3.32509
2023-04-16 12:33:34.653920 Epoch 24  	Train Loss = 3.56767 Val Loss = 3.32444
2023-04-16 12:33:51.837711 Epoch 25  	Train Loss = 3.56761 Val Loss = 3.32611
2023-04-16 12:34:08.124836 Epoch 26  	Train Loss = 3.56662 Val Loss = 3.32629
2023-04-16 12:34:25.230671 Epoch 27  	Train Loss = 3.56735 Val Loss = 3.32425
2023-04-16 12:34:42.243262 Epoch 28  	Train Loss = 3.56722 Val Loss = 3.32709
2023-04-16 12:34:59.307996 Epoch 29  	Train Loss = 3.56679 Val Loss = 3.32560
2023-04-16 12:35:16.539676 Epoch 30  	Train Loss = 3.56718 Val Loss = 3.32661
2023-04-16 12:35:33.933933 Epoch 31  	Train Loss = 3.56605 Val Loss = 3.32634
2023-04-16 12:35:50.820118 Epoch 32  	Train Loss = 3.56722 Val Loss = 3.32633
2023-04-16 12:36:08.045385 Epoch 33  	Train Loss = 3.56497 Val Loss = 3.32545
2023-04-16 12:36:25.356277 Epoch 34  	Train Loss = 3.56614 Val Loss = 3.32547
2023-04-16 12:36:42.425211 Epoch 35  	Train Loss = 3.56452 Val Loss = 3.32443
2023-04-16 12:36:59.456113 Epoch 36  	Train Loss = 3.56456 Val Loss = 3.32535
2023-04-16 12:37:16.707332 Epoch 37  	Train Loss = 3.56549 Val Loss = 3.32509
Early stopping at epoch: 37
Best at epoch 27:
Train Loss = 3.56735
Train RMSE = 7.33239, MAE = 3.56352, MAPE = 9.83642
Val Loss = 3.32425
Val RMSE = 7.17604, MAE = 3.39116, MAPE = 9.61360
--------- Test ---------
All Steps RMSE = 7.73326, MAE = 3.79123, MAPE = 10.81135
Step 1 RMSE = 4.28108, MAE = 2.41783, MAPE = 5.92949
Step 2 RMSE = 5.33991, MAE = 2.78412, MAPE = 7.15624
Step 3 RMSE = 6.08550, MAE = 3.06792, MAPE = 8.13792
Step 4 RMSE = 6.68605, MAE = 3.31741, MAPE = 9.03080
Step 5 RMSE = 7.19916, MAE = 3.54727, MAPE = 9.86913
Step 6 RMSE = 7.65523, MAE = 3.76553, MAPE = 10.67565
Step 7 RMSE = 8.06879, MAE = 3.97074, MAPE = 11.43506
Step 8 RMSE = 8.44389, MAE = 4.16652, MAPE = 12.16255
Step 9 RMSE = 8.78360, MAE = 4.35111, MAPE = 12.84941
Step 10 RMSE = 9.10287, MAE = 4.52930, MAPE = 13.50947
Step 11 RMSE = 9.40234, MAE = 4.70320, MAPE = 14.16477
Step 12 RMSE = 9.68567, MAE = 4.87394, MAPE = 14.81628
Inference time: 1.36 s
